[
    {
        "text": "@rackneng `uname -m` returns `armv7l`on a R-Pi and `aarch64` on an oDroid",
        "username": "chriscowley",
        "bot_id": "B41PS9J94",
        "type": "message",
        "subtype": "bot_message",
        "ts": "1510819371.000037"
    },
    {
        "text": "@rackneng (I reckon  a Pine64 will also return `aarch64`)",
        "username": "chriscowley",
        "bot_id": "B41PS9J94",
        "type": "message",
        "subtype": "bot_message",
        "ts": "1510819407.000289"
    },
    {
        "text": "This may be in the docs, but I haven't seen it. Are you capable of deploying a Windows client OS?",
        "username": "chriscowley",
        "bot_id": "B41PS9J94",
        "type": "message",
        "subtype": "bot_message",
        "ts": "1510822382.000134"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "Not in community.  You would need to work with RackN.  The problem is that we are still building up the patterns for that.  Also it depends upon your starting windows position. ",
        "ts": "1510835191.000348"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "@chriscowley - thx for the uname's",
        "ts": "1510841247.000346"
    },
    {
        "type": "message",
        "subtype": "pinned_item",
        "user": "U7ZBWDABW",
        "item_type": "C",
        "attachments": [
            {
                "fallback": "[November 15th, 2017 10:25 AM] shane: the (minimal) UX doc we have is:\n<http:\/\/provision.readthedocs.io\/en\/latest\/doc\/ui.html#reservations>\nor - via the `drpcli` command line, you could do:\n```echo '{\n  \"Addr\": \"1.2.3.4\",\n  \"Available\": true,\n  \"NextServer\": \"1.2.3.10\",\n  \"Options\": [],\n  \"ReadOnly\": false,\n  \"Strategy\": \"MAC\",\n  \"Token\": \"00:0c:3f:f1:13:d3\"\n}'  &gt; my_reservation.json\ndrpcli reservations create -&lt; my_reservation.json```",
                "ts": "1510770300.000424",
                "author_id": "U6QFVRJNB",
                "author_subname": "Shane Gibson",
                "channel_id": "C02L9P26Q",
                "channel_name": "community",
                "is_msg_unfurl": true,
                "text": "the (minimal) UX doc we have is:\n<http:\/\/provision.readthedocs.io\/en\/latest\/doc\/ui.html#reservations>\nor - via the `drpcli` command line, you could do:\n```echo '{\n  \"Addr\": \"1.2.3.4\",\n  \"Available\": true,\n  \"NextServer\": \"1.2.3.10\",\n  \"Options\": [],\n  \"ReadOnly\": false,\n  \"Strategy\": \"MAC\",\n  \"Token\": \"00:0c:3f:f1:13:d3\"\n}'  &gt; my_reservation.json\ndrpcli reservations create -&lt; my_reservation.json```",
                "author_name": "Shane Gibson",
                "author_link": "https:\/\/rackn.slack.com\/team\/U6QFVRJNB",
                "author_icon": "https:\/\/avatars.slack-edge.com\/2017-09-18\/243018470675_611b6896ed20358ab1aa_48.jpg",
                "mrkdwn_in": [
                    "text"
                ]
            }
        ],
        "text": "<@U7ZBWDABW> pinned a message to this channel.",
        "ts": "1510844571.000280"
    },
    {
        "user": "U81N5R0LS",
        "text": "<@U81N5R0LS> has joined the channel",
        "type": "message",
        "subtype": "channel_join",
        "ts": "1510862469.000683"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "hmm...something in a recent update is causing our builds to fail here...\n```\n+ \/usr\/local\/bin\/drpcli machines processjobs e6de1551-4be6-4b9c-b4bb-d960b39a2421\nSegmentation fault\n```",
        "ts": "1510867910.000666"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "<@U54E4SD4G> are you using \"tip\"?  what version?",
        "ts": "1510867982.000473"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "can you do a `strings` on the drpcli binary ?",
        "ts": "1510868004.000652"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "iteration is taking a while",
        "ts": "1510868045.000145"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "sorry - don't do \"strings\" :slightly_smiling_face:",
        "ts": "1510868058.000580"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "oh wait right it's on the drp server",
        "ts": "1510868059.000105"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "hold on",
        "ts": "1510868065.000285"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "I meant `file` to make sure binary architecture is right",
        "ts": "1510868083.000338"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "so it's too late for me to get the original version that segfaulted",
        "ts": "1510868096.000639"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "583d0f24e1fd02140603ce096421467f  \/var\/lib\/dr-provision\/tftpboot\/files\/drpcli.amd64.linux\nbut this was the md5sum",
        "ts": "1510868102.000178"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "I updated to current tip and the segfault still occurs",
        "ts": "1510868112.000421"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "and also yeah I checked that the arch was right:\n```\n+ uname -a\nLinux (none) 4.1.15 #1 SMP Sun Aug 6 23:01:53 PDT 2017 x86_64 GNU\/Linux\n```",
        "edited": {
            "user": "U54E4SD4G",
            "ts": "1510868171.000000"
        },
        "ts": "1510868163.000200"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "Right now I'm trying a provision with 3.2.1's binary",
        "ts": "1510868183.000287"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "3.2.1 also segfaulted (trying 3.1.0 now)",
        "ts": "1510868378.000005"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "I think the one that was previously working with this bootenv\/stage was tip sometime after 3.1.0 :v",
        "ts": "1510868426.000319"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "ok - I just deployed `tip` version on x86_64 linux (centos 7) - no problems",
        "ts": "1510868472.000719"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "```root@demo:~\/foo$ uname -a\nLinux 5min-drp-ewr1-00 3.10.0-327.22.2.el7.x86_64 #1 SMP Thu Jun 23 17:05:11 UTC 2016 x86_64 x86_64 x86_64 GNU\/Linux\nroot@demo:~\/foo$ .\/drpcli version\nVersion: v3.2.1-tip-41-6894ee85c5c018192ba9ce9b7378fd0fece724d7```",
        "ts": "1510868530.000046"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "yeah centos 7 worked fine for me (used it for deploying atomic yesterday)",
        "ts": "1510868560.000324"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "this is an in-house distro",
        "ts": "1510868580.000103"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "cool",
        "ts": "1510868584.000329"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "hmm",
        "ts": "1510868622.000079"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "it still segfaulted",
        "ts": "1510868625.000576"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "I did add some armv8 (aarm64) and armv7 (armv7l) architecture builds within the last few days - that includes modifications to the \"install.sh\" script to stick the \"right\" binaries in place for a \"deployment\" install",
        "ts": "1510868630.000318"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "can something wrong with the tasks cause the segfault, you think?",
        "ts": "1510868641.000421"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "I wouldn't think tasks or plugins would cause `drpcli` issues - maybe `dr-provision` binary ...",
        "ts": "1510868697.000599"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "are you running the binary via PATH locating - or directly via fully qualified path ?",
        "ts": "1510868718.000216"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "dr-provision?",
        "ts": "1510868729.000082"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "or drpcli",
        "ts": "1510868731.000501"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "it's drpcli you said that segfaulted, right ?",
        "ts": "1510868747.000304"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "correct",
        "ts": "1510868753.000613"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "`\/usr\/local\/bin\/drpcli machines processjobs \"e6de1551-4be6-4b9c-b4bb-d960b39a2421\"`",
        "ts": "1510868776.000400"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "ok - so this is occurring on a Machine you're trying to provision during a stage, right ?",
        "ts": "1510868938.000184"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "correct",
        "ts": "1510868965.000232"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "are you able to manually run `drpcli` on the machine - say, just w\/ the \"version\" flag ?",
        "ts": "1510868990.000375"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "does it segfault then ?",
        "ts": "1510868993.000426"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "or any other non \"processjobs\" actions",
        "ts": "1510869001.000039"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "not interactively, I can add it to the template though, hold on",
        "ts": "1510869015.000277"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "well, I added it but I also had redeployed dr-provision 3.2.1",
        "ts": "1510869187.000565"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "so we'll see",
        "ts": "1510869193.000390"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "ok",
        "ts": "1510869199.000050"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "still segfaults",
        "ts": "1510869463.000063"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "with version",
        "ts": "1510869473.000415"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "you have access to the Machine ?",
        "ts": "1510869488.000260"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "hm.  Any stacktraces?",
        "ts": "1510869516.000265"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "yeah - was hoping you could try and capture one off of the machine",
        "ts": "1510869536.000237"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "access as in?",
        "ts": "1510869538.000211"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "ssh",
        "ts": "1510869541.000236"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "console",
        "ts": "1510869544.000322"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "technically I'm attached to console, though it'll be a bit more effort to bring up an interactive one within this image",
        "ts": "1510869573.000018"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "hold on lemme try something",
        "ts": "1510869613.000169"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "the image is also probably going to be really limited though, I don't think strace will be in it",
        "ts": "1510869676.000542"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "If it is not spitting out a stacktrace on the console, check dmesg to see if it has anything weird.",
        "ts": "1510869889.000412"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "also, is it happening on just one machine or on more than one?",
        "ts": "1510869912.000183"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "I need to make a separate bootenv\/stage - will report soon",
        "ts": "1510870497.000576"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "Also, if you have a core dump, I suppose now is as good a time as ever to learn how gdb and go binaries interact. :slightly_smiling_face:",
        "ts": "1510871106.000294"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "And by now, I of course mean after I get home. :slightly_smiling_face:",
        "ts": "1510871136.000396"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "alright",
        "ts": "1510871988.000086"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "I should have paid more heed to this particular message:",
        "ts": "1510872007.000131"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "```\n# wget -O drpcli \"$ProvURL\/files\/drpcli.amd64.linux\"\nConnecting to 10.11.110.50:8091 (10.11.110.50:8091)\nwget: short write\n```",
        "ts": "1510872012.000508"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "```\n# mount -t tmpfs -o size=1g tmpfs \/tmp\n# cd \/tmp\n# wget -O drpcli \"$ProvURL\/files\/drpcli.amd64.linux\"\nConnecting to 10.11.110.50:8091 (10.11.110.50:8091)\ndrpcli               100% |*******************************| 20885k  0:00:00 ETA\n# md5sum drpcli\n3200370360a384e28bd3ca3a54d2e5e8  drpcli\n# chmod +x drpcli\n# .\/drpcli version\nVersion: v3.2.1-0-2ab654478528d1ee59781f7d53bc8f8b9c6853dd\n```",
        "ts": "1510872064.000231"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "so basically \/ filled up when fetching drpcli",
        "ts": "1510872096.000520"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "oye !",
        "ts": "1510872228.000147"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "jeesh - drpcli is a pretty slim binary !!",
        "ts": "1510872244.000027"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "there's too much code I didn't write to actually look through, but this is the first time I was running this bootenv (fireeye's appliance OS's manufacturing images) on this particular model of appliance, and I know that the manufacturing image does check for model and stuff so it might have, idk, made \/ a smaller fs than for other appliances that I know it's worked on",
        "ts": "1510872326.000300"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "I actually had to make \/tmp a tmpfs in order to run processjobs for other appliances anyway because of the code it pulled, might as well just drop drpcli there instead of \/usr\/local\/bin",
        "edited": {
            "user": "U54E4SD4G",
            "ts": "1510872404.000000"
        },
        "ts": "1510872395.000247"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "(due to lack of space)",
        "ts": "1510872412.000107"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "time to upgrade drp back to tip",
        "ts": "1510872449.000305"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "cool - glad it was a simple environment issue !",
        "ts": "1510872486.000271"
    },
    {
        "user": "U820L71L5",
        "text": "<@U820L71L5> has joined the channel",
        "type": "message",
        "subtype": "channel_join",
        "ts": "1510876563.000061"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "so one thing i noticed but haven't had much chance to look into is that if the bootenv\/stage is set to sledgehammer when a Machine boots up then it doesn't install SSH keys",
        "ts": "1510877650.000082"
    },
    {
        "type": "message",
        "user": "U54E4SD4G",
        "text": "I think that step might be missing on the sledgehammer stages specifically? (something about it being in control.sh in the discovery bootenv but that doesn't get used by sledgehammer last I looked)",
        "ts": "1510877737.000338"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "<@U820L71L5> welcome",
        "ts": "1510881000.000119"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "ssh keys are not installed until after OS (bootenv) is installed - we do have an option to inject SSH keys in to Sledgehammer live boot - but it doesn't do that by default",
        "ts": "1510881041.000242"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "<@U54E4SD4G> ^^",
        "ts": "1510881048.000143"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "@chriscowley - I have an armv7 build done - it's not pushed for deployment yet - but if you have hardware you want to play with it on - let me know",
        "ts": "1510890924.000006"
    }
]