[
    {
        "user": "U8U5XTV97",
        "text": "<@U8U5XTV97> has joined the channel",
        "type": "message",
        "subtype": "channel_join",
        "ts": "1516266152.000042"
    },
    {
        "text": "ok  still not getting these reservations ive added a MAC and ip for the machines but they still dhcp a new ip from the pool and boot into sledgehammer insead of off disk",
        "username": "outbackdingo",
        "bot_id": "B41PS9J94",
        "type": "message",
        "subtype": "bot_message",
        "ts": "1516278215.000310"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "sorryim here now .... ok  still not getting these reservations ive added a MAC and ip for the machines but they still dhcp a new ip from the pool and boot into sledgehammer instead of off disk",
        "ts": "1516279733.000247"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "<@U855MAQFL> How important is it to you to preserve the current machine records in DRP?",
        "ts": "1516280432.000086"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "And, I'm assuming you are providing DHCP to your provisioning network via DRP?",
        "ts": "1516280482.000340"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U416T0AAX> i have 10 machines already prebuilt \/ booting from hard disk...  i dont want drpto do anything to",
        "ts": "1516280484.000083"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "It seems that the machine records are tied to the IP address, not the MAC... If the IP changes, DRP would see it as a new machine (my understanding)",
        "ts": "1516280599.000196"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "To wit:\n```\n$ drpcli -E <https:\/\/192.168.1.148:8092> machines show 174c3987-22a4-43d4-9eb9-0247162e8628 | jq 'del(.Params.\"gohai-inventory\")'\n\n{\n  \"Address\": \"192.168.1.102\",\n  \"Available\": true,\n  \"BootEnv\": \"local\",\n  \"CurrentJob\": \"9d7d2564-26b4-439e-a049-c5b959b6da32\",\n  \"CurrentTask\": 0,\n  \"Description\": \"Dell PowerEdge R310\",\n  \"Errors\": [],\n  \"Meta\": {\n    \"feature-flags\": \"change-stage-v2\"\n  },\n  \"Name\": \"k8s-ingress\",\n  \"OS\": \"ubuntu-16.04\",\n  \"Params\": {\n    \"ipmi\/address\": \"idrac-796MQW1\",\n    \"ipmi\/password\": \"********\",\n    \"ipmi\/username\": \"root\"\n  },\n  \"Profile\": {\n    \"Available\": false,\n    \"Description\": \"\",\n    \"Errors\": null,\n    \"Meta\": null,\n    \"Name\": \"\",\n    \"Params\": null,\n    \"ReadOnly\": false,\n    \"Validated\": false\n  },\n  \"Profiles\": [\n    \"k8s-cluster1\"\n  ],\n  \"ReadOnly\": false,\n  \"Runnable\": true,\n  \"Secret\": \"*********\",\n  \"Stage\": \"complete\",\n  \"Tasks\": [],\n  \"Uuid\": \"174c3987-22a4-43d4-9eb9-0247162e8628\",\n  \"Validated\": true\n}\n```",
        "ts": "1516280649.000202"
    },
    {
        "text": "Time to feed the :bear:!",
        "type": "message",
        "subtype": "slackbot_response",
        "user": "USLACKBOT",
        "ts": "1516280649.000276"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Notice there is only an \"Address\" attribute, and no \"MAC\" attribute",
        "ts": "1516280690.000460"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U416T0AAX> there is address \/ token \/ strategy which translates to 2xx.3xx.4xx.4xx   \/ ba:25:96:29:71:1f \/ MAC",
        "ts": "1516280894.000215"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "at least thats whats in the ui",
        "ts": "1516280904.000375"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "and <@U6QFVRJNB> sent me this  last night <http:\/\/provision.readthedocs.io\/en\/latest\/doc\/operation.html#creating-a-reservation>",
        "ts": "1516280968.000248"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "drpcli reservations create '{ \"Addr\": \"1.1.1.1\", \"Token\": \"08:00:27:33:77:de\", \"Strategy\": \"MAC\" }'",
        "ts": "1516281014.000006"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "now... seemingly my reservations ip are outside the configured subnet scope",
        "ts": "1516281071.000144"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "148.251.24.7\/27\t148.251.24.11\t148.251.24.29\t6000\t72000 is my subnet",
        "ts": "1516281115.000031"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "my reservation is 148.251.24.4\tda:45:cf:f6:6b:11\tMAC",
        "ts": "1516281187.000314"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "be smarter if we could simple \"ignore\" the MAC - do nothing",
        "ts": "1516281236.000285"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "<@U855MAQFL> You can't ignore the MAC - that's what DHCP uses to know what machine gets what IP",
        "ts": "1516281356.000554"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "And reservations should be outside of the dynamic address pool",
        "ts": "1516281410.000363"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "but its ignoring the reservation",
        "ts": "1516281427.000176"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Does it already have a dynamic lease in the \"db\" for that MAC?",
        "ts": "1516281459.000139"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "it boots into sledgehammer",
        "ts": "1516281461.000071"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "You'd have to remove the dynamic lease record first; the DHCP server would already \"know\" what IP addr goes with that MAC",
        "ts": "1516281520.000422"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Do this - run this command and post back what it says:\n`drpcli machines list -E https:\/\/&lt;your-drp-ip&gt;:8092 | jq '.[] | .Name + \", \" + .Address + \", \" + .BootEnv'`\nFor instance, on my DRP system, I get:\n```\n\"testinstall, 192.168.1.125, local\"\n\"k8s-ingress, 192.168.1.102, local\"\n\"testnode03, 192.168.1.114, local\"\n\"testnode04, 192.168.1.132, local\"\n\"testnode02, 192.168.1.110, local\"\n\"testnode01, 192.168.1.123, local\"\n\"is-ef-n1, 192.168.1.112, sledgehammer\"\n```",
        "ts": "1516281730.000257"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "(you don't need the `-E https:\/\/&lt;your-drp-ip&gt;:8092` part if you are running `drpcli` off the DRP host itself - that's for a remote `drpcli`)",
        "ts": "1516281787.000187"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "I will take a look at that.",
        "ts": "1516284727.000193"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "<@U02DJQSG8> at what?",
        "ts": "1516284753.000206"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "precreated reservations and machines not behaving the way you expect.",
        "ts": "1516284777.000093"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "ah",
        "ts": "1516284784.000072"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "If there exists a dyn lease record for a MAC, and then one enters a static lease record for that same MAC, which one \"wins\"?",
        "edited": {
            "user": "U416T0AAX",
            "ts": "1516284903.000000"
        },
        "ts": "1516284845.000155"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "<@U855MAQFL> Is that example machine you poseted above one that you precreated and expect it to boot into Sledgehammer, or something else?",
        "ts": "1516284869.000360"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "<@U8U5XTV97> welcome",
        "ts": "1516284894.000066"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "I'm working through the same sort of thing except with an array of ILO devices...\nWondering about 'missing mac'",
        "ts": "1516284978.000002"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Or does (should) the DRP system detect a prior MAC entry, and remove it in favor of the new one? (not sure how this works w\/ DRP DHCP server)",
        "ts": "1516284984.000425"
    },
    {
        "type": "message",
        "subtype": "file_share",
        "text": "<@U62R1805P> uploaded a file: <https:\/\/rackn.slack.com\/files\/U62R1805P\/F8USDCQAW\/missing_mac.txt|missing mac>",
        "file": {
            "id": "F8USDCQAW",
            "created": 1516284999,
            "timestamp": 1516284999,
            "name": "missing_mac.txt",
            "title": "missing mac",
            "mimetype": "text\/plain",
            "filetype": "text",
            "pretty_type": "Plain Text",
            "user": "U62R1805P",
            "editable": true,
            "size": 1062,
            "mode": "snippet",
            "is_external": false,
            "external_type": "",
            "is_public": true,
            "public_url_shared": false,
            "display_as_bot": false,
            "username": "",
            "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-F8USDCQAW\/missing_mac.txt?t=xoxe-2458848645-331142845857-332542502102-c2a3393bdc66e7bf33d1c6986e4eea64",
            "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-F8USDCQAW\/download\/missing_mac.txt?t=xoxe-2458848645-331142845857-332542502102-c2a3393bdc66e7bf33d1c6986e4eea64",
            "permalink": "https:\/\/rackn.slack.com\/files\/U62R1805P\/F8USDCQAW\/missing_mac.txt",
            "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-F8USDCQAW-884dcde5aa",
            "edit_link": "https:\/\/rackn.slack.com\/files\/U62R1805P\/F8USDCQAW\/missing_mac.txt\/edit",
            "preview": "[drpops@drpe drpisolated]$ .\/drpcli leases list -E https:\/\/192.168.88.3:8092 | jq '.[] | .Addr + \", \" + .Token'\r\n\"192.168.88.100, 3c:07:54:72:49:e2\"\r\n\"192.168.88.101, 08:00:27:66:d8:66\"\r\n\"192.168.88.102, 00:22:64:9d:25:1d\"\r\n\"192.168.88.103, 00:23:05:81:b2:37\"\r",
            "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>[drpops@drpe drpisolated]$ .\/drpcli leases list -E https:\/\/192.168.88.3:8092 | jq '.[] | .Addr + &quot;, &quot; + .Token'<\/pre><\/div>\n<div><pre>&quot;192.168.88.100, 3c:07:54:72:49:e2&quot;<\/pre><\/div>\n<div><pre>&quot;192.168.88.101, 08:00:27:66:d8:66&quot;<\/pre><\/div>\n<div><pre>&quot;192.168.88.102, 00:22:64:9d:25:1d&quot;<\/pre><\/div>\n<div><pre>&quot;192.168.88.103, 00:23:05:81:b2:37&quot;<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<\/div>\n<\/div>\n",
            "lines": 23,
            "lines_more": 18,
            "preview_is_truncated": true,
            "channels": [],
            "groups": [],
            "ims": [],
            "comments_count": 0
        },
        "user": "U62R1805P",
        "upload": true,
        "display_as_bot": false,
        "username": "ctrees",
        "bot_id": null,
        "ts": "1516284999.000559"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "<@U62R1805P> Do you have any statics mapped?",
        "edited": {
            "user": "U416T0AAX",
            "ts": "1516285088.000000"
        },
        "ts": "1516285074.000275"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "mapped in drp ? or ?",
        "ts": "1516285111.000153"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "yes, in DRP",
        "ts": "1516285119.000180"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Or are you using outboard DHCP?",
        "ts": "1516285130.000255"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "<@U62R1805P> - Add `.State` to your jq magic.",
        "ts": "1516285145.000320"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "what I did was put statics outside the DHCP",
        "ts": "1516285146.000058"
    },
    {
        "type": "message",
        "subtype": "file_share",
        "text": "<@U62R1805P> uploaded a file: <https:\/\/rackn.slack.com\/files\/U62R1805P\/F8US2HX4L\/ah___.txt|Ah...>",
        "file": {
            "id": "F8US2HX4L",
            "created": 1516285254,
            "timestamp": 1516285254,
            "name": "Ah___.txt",
            "title": "Ah...",
            "mimetype": "text\/plain",
            "filetype": "text",
            "pretty_type": "Plain Text",
            "user": "U62R1805P",
            "editable": true,
            "size": 754,
            "mode": "snippet",
            "is_external": false,
            "external_type": "",
            "is_public": true,
            "public_url_shared": false,
            "display_as_bot": false,
            "username": "",
            "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-F8US2HX4L\/ah___.txt?t=xoxe-2458848645-331142845857-332542502102-c2a3393bdc66e7bf33d1c6986e4eea64",
            "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-F8US2HX4L\/download\/ah___.txt?t=xoxe-2458848645-331142845857-332542502102-c2a3393bdc66e7bf33d1c6986e4eea64",
            "permalink": "https:\/\/rackn.slack.com\/files\/U62R1805P\/F8US2HX4L\/ah___.txt",
            "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-F8US2HX4L-2c6fd995ee",
            "edit_link": "https:\/\/rackn.slack.com\/files\/U62R1805P\/F8US2HX4L\/ah___.txt\/edit",
            "preview": "Ah...\r\n\r\n\"192.168.88.100, 3c:07:54:72:49:e2, ACK\"\r\n\"192.168.88.101, 08:00:27:66:d8:66, ACK\"\r\n\"192.168.88.102, 00:22:64:9d:25:1d, ACK\"\r",
            "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>Ah...<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<div><pre>&quot;192.168.88.100, 3c:07:54:72:49:e2, ACK&quot;<\/pre><\/div>\n<div><pre>&quot;192.168.88.101, 08:00:27:66:d8:66, ACK&quot;<\/pre><\/div>\n<div><pre>&quot;192.168.88.102, 00:22:64:9d:25:1d, ACK&quot;<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<\/div>\n<\/div>\n",
            "lines": 21,
            "lines_more": 16,
            "preview_is_truncated": false,
            "channels": [],
            "groups": [],
            "ims": [],
            "comments_count": 0
        },
        "user": "U62R1805P",
        "upload": true,
        "display_as_bot": false,
        "username": "ctrees",
        "bot_id": null,
        "ts": "1516285255.000393"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "So, `INVALID` means that DRP decided they weren’t safe to use.  Either something responded to ping or they were NAKed by the client.",
        "ts": "1516285312.000391"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "`ACK` means what it sounds like",
        "ts": "1516285319.000564"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "`OFFER` means pending.",
        "ts": "1516285327.000390"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "hum... so with <@U02DJQSG8> websocket log alert... I could just listen to 'traffic' on a 'dirty toilet' and 'clean-up' a network... hum...",
        "ts": "1516285449.000812"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "umm - not perhaps how I would have put it, but yes.",
        "ts": "1516285474.000455"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "how does something make a request without a mac ?",
        "ts": "1516285872.000043"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "<@U62R1805P> How would that work?",
        "ts": "1516285901.000082"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "you mean the toilet thing?",
        "ts": "1516285934.000036"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "No, \"make a request without a mac\"",
        "ts": "1516285952.000666"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "don't know... that's what I'm curious about... if it's INVALID... I'd like to figure out where it came from... and would think a mac would be involved",
        "ts": "1516286023.000434"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "for drp to even see it... it'd have to be in at least arp ?",
        "ts": "1516286066.000488"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "ARP is MAC (layer 2) to IP (layer 3) mapping",
        "ts": "1516286126.000117"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "See this for how DHCP works:\n<https:\/\/www.scribd.com\/doc\/24445850\/DORA-Process-in-DHCP-DHCP-D-Iscover-DHCP-O-Ffer>",
        "attachments": [
            {
                "service_name": "Scribd",
                "title": "DORA Process in DHCP DHCP (D)Iscover | DHCP (O)Ffer  | Internet Protocols | Networks",
                "title_link": "https:\/\/www.scribd.com\/doc\/24445850\/DORA-Process-in-DHCP-DHCP-D-Iscover-DHCP-O-Ffer",
                "text": "DHCP-DORA",
                "fallback": "Scribd: DORA Process in DHCP DHCP (D)Iscover | DHCP (O)Ffer  | Internet Protocols | Networks",
                "thumb_url": "https:\/\/imgv2-2-f.scribdassets.com\/img\/document\/24445850\/original\/37ab298f51\/1516286058?v=1",
                "from_url": "https:\/\/www.scribd.com\/doc\/24445850\/DORA-Process-in-DHCP-DHCP-D-Iscover-DHCP-O-Ffer",
                "thumb_width": 768,
                "thumb_height": 994,
                "service_icon": "https:\/\/www.scribd.com\/favicon.ico?v=4",
                "id": 1
            }
        ],
        "ts": "1516286152.000739"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "thanks",
        "ts": "1516286214.000761"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U02DJQSG8> the machines  were all created staically addressed before rebar was  deployed now with reboo if we reboot one it drops it into sledehammer",
        "ts": "1516286233.000377"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "so i shut down rebar and rebooted the static machine o its orig state then started rebar again and created a \"reservation\" however rebar still tries to install it",
        "ts": "1516286298.000308"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "<@U855MAQFL> Do you have a DHCP server that is separate from DRP on your deployment network?",
        "ts": "1516286419.000192"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "no the only thin doing dhcp is rebarthe machines in question have a \"static\" ip",
        "ts": "1516286450.000135"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "ok",
        "ts": "1516286473.000530"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "So, they do NOT use DHCP to address themselves?",
        "ts": "1516286483.000263"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "Can you give me an example of what JSON you are passing in to create the machine and the reservation?",
        "ts": "1516286496.000229"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U02DJQSG8> i did it in the ui",
        "ts": "1516286520.000534"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "DRP uses ping to see if it can issue a lease, not ARP.",
        "ts": "1516286526.000214"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "just ip mac address and MAC",
        "ts": "1516286528.000295"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Ah I see - perhaps he's creating machine rec's manually",
        "ts": "1516286537.000087"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "well they pxe boot",
        "ts": "1516286541.000159"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U02DJQSG8> want to see  the ui ?",
        "ts": "1516286610.000012"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "we use ping because arp is limited to the local subnet, and we can handle remote subnets.",
        "ts": "1516286631.000586"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "<@U855MAQFL> I am more interested in what the JSON for the machine winds up looking like.",
        "ts": "1516286651.000923"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "these 10 ips are in the samesubnet which is why i created a reservation for them thinking they would just get the sameip and boo from disk",
        "ts": "1516286675.000206"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "i guess weneed rebar to think its already done is job for these ips :slightly_smiling_face:",
        "ts": "1516286722.000863"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "right, whicn is why I need to see what the machine JSON looks like from the CLI",
        "ts": "1516286726.000369"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Q: does PXE always use DHCP? Or can you somehow assign static to the PXE-boot bios for the NIC?",
        "ts": "1516286736.000359"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "PXE is a pseudo-standard layered on top of DHCP",
        "ts": "1516286762.000320"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "I've never done PXE without DHCP being involved...",
        "ts": "1516286779.000160"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "lol \"pseudo-standard\"",
        "ts": "1516286808.000257"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "If it isn't an RFC, ANSI, ISO, or similar standard, it is a pseudo-standard. :slightly_smiling_face:",
        "ts": "1516286831.000772"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Welcome to your hell :wink:",
        "ts": "1516286853.000537"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U02DJQSG8> ok how do i get that data for you from the cli?",
        "ts": "1516286873.000740"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "drpcli leases list \n[\n  {\n    \"Addr\": \"148.251.24.5\",\n    \"Available\": true,\n    \"Errors\": [],\n    \"ExpireTime\": \"2018-01-18T10:01:58.851340004-05:00\",\n    \"Meta\": {},\n    \"ReadOnly\": false,\n    \"State\": \"ACK\",\n    \"Strategy\": \"MAC\",\n    \"Token\": \"ba:25:96:29:71:1f\",\n    \"Validated\": true\n  },",
        "ts": "1516286928.000582"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "drpcli machines get Name:&lt;machine name&gt;",
        "ts": "1516286970.000254"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "drpcli reservations list \n[\n  {\n    \"Addr\": \"148.251.24.4\",\n    \"Available\": true,\n    \"Errors\": [],\n    \"Meta\": {},\n    \"NextServer\": \"\",\n    \"Options\": [],\n    \"ReadOnly\": false,\n    \"Strategy\": \"MAC\",\n    \"Token\": \"da:45:cf:f6:6b:11\",\n    \"Validated\": true\n  },\n  {\n    \"Addr\": \"148.251.24.5\",\n    \"Available\": true,\n    \"Errors\": [],\n    \"Meta\": {},\n    \"NextServer\": \"\",\n    \"Options\": [],\n    \"ReadOnly\": false,\n    \"Strategy\": \"MAC\",\n    \"Token\": \"ba:25:96:29:71:1f\",\n    \"Validated\": true\n  }\n]",
        "ts": "1516286983.000746"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "will get a single name.",
        "ts": "1516286992.000619"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "<@U855MAQFL> PM that to me?",
        "ts": "1516287006.000652"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "(please use \"Snippet\" -- the plus symbol to left of input box -- in Slack for code like the above)",
        "ts": "1516287014.000846"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "(it helps make long info collapsible and makes the channel more readable)",
        "ts": "1516287034.000044"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "yeah, that too. :slightly_smiling_face:",
        "ts": "1516287048.000485"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "And remeber to filter the gohai stuff out -- `drpcli machines list | jq '.[] | del(.Params.\"gohai-inventory\")'`",
        "ts": "1516287080.000690"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "aw, but I wirked so hard to write that. :slightly_smiling_face:",
        "ts": "1516287108.000606"
    },
    {
        "type": "message",
        "user": "U416T0AAX",
        "text": "Dude - it's awesome, but oh the output lines :joy:",
        "ts": "1516287140.000490"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "jeeeez howw do you pm someone in slack",
        "ts": "1516287175.000052"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "scroll down on left panel",
        "ts": "1516287189.000577"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "find Direct Messages - click on + to pop up selection panel",
        "ts": "1516287209.000106"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "or - you can use `\/msg` command",
        "ts": "1516287229.000290"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "or `\/dm` command",
        "ts": "1516287247.000597"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "yupp got it",
        "ts": "1516287253.000331"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "so anyway... not that i want to be rebooting our mail server often but it did just happen lucky for us it wasnt totally automated of wed have a fresh install",
        "ts": "1516287736.000007"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "and no more mailserver",
        "ts": "1516287744.000234"
    },
    {
        "type": "message",
        "user": "U02DHRR2L",
        "text": "<@U855MAQFL> I'd suggest not having install-os as a default if you are mixing production servers into your process.  Discovery is a safer default since it's not destructive.",
        "ts": "1516293257.000124"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "welp <@U02DJQSG8> solved my existing systems issue nicely",
        "ts": "1516295655.000918"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "tl;dr: to keep DRP from messing with a machine, create a reservation for it and create a machine with the reserved IP, stage none and bootenv local",
        "edited": {
            "user": "U02DJQSG8",
            "ts": "1516296018.000000"
        },
        "ts": "1516295970.000251"
    },
    {
        "type": "message",
        "user": "U02DJQSG8",
        "text": "That will make sure it gets a consistent IP, that it has no tasks to run, and that the PXE files we write for it will have it boot to the local disk.",
        "ts": "1516296081.000131"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "ok... coll all machines created.... no onto configuring a workflow....",
        "ts": "1516297169.000336"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "or should i tackle kribs for my infrastructure first :slightly_smiling_face:",
        "ts": "1516297194.000765"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "KRIBs is just a workflow - nothing more",
        "ts": "1516301016.000280"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "seems the work flow.....ivegott 3 systes that did the centos-install and rebooed now they jus seemto be sitting here",
        "ts": "1516303016.000528"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "static\t4a4900b9-4116-4057-aee0-84219ad6d12b\t148.251.24.13\tlocal\tlocal\t\t\nstatic\t7b17aa61-2b44-4d1a-8333-d3ea105bc1d1\t148.251.24.14\tlocal\tlocal\t\t\nstatic\t8580bec6-c2d2-420e-bc10-42bf87c25c89\t148.251.24.15\tlocal\tlocal",
        "ts": "1516303082.000118"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "\"sitting where\"",
        "ts": "1516303796.000405"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "you have those 3 systems to boot to local disk - not to do any provisioning with \"local\/local\"",
        "ts": "1516303820.000420"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "drpcli profiles show k8s-cluster | jq -r '.Params.\"krib\/cluster-master\"'\nnull",
        "ts": "1516303907.000149"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U6QFVRJNB> i followed the kribs guide",
        "ts": "1516304026.000390"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "for install-to-local-disk mode:\ncentos-7-install -&gt; runner-service:Success\nrunner-service -&gt; finish-install:Stop\nfinish-install -&gt; docker-install:Success\ndocker-install -&gt; krib-install:Success\nkrib-install-&gt; complete:Success\ndiscover-&gt;sledgehammer-wait:Success",
        "ts": "1516304063.000222"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "please show me the command you used to display your 3 machines above",
        "ts": "1516304152.000505"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U6QFVRJNB> that was pasted from the ui under machines",
        "edited": {
            "user": "U855MAQFL",
            "ts": "1516304390.000000"
        },
        "ts": "1516304360.000609"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "right - so \"local\" stage and \"local\" bootenv tells Digital Rebar Provision to ignore the Machines and have them just boot to the locally installed operating system",
        "ts": "1516304405.000602"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "you can not perform any further workflow or provisioning",
        "ts": "1516304415.000010"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "you must change the machines Stage to start it on the work flow for KRIB",
        "ts": "1516304425.000186"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "i did that",
        "ts": "1516304436.000386"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "i edited each and added the profile",
        "ts": "1516304452.000060"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "then rebooted per the instructions",
        "ts": "1516304461.000158"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "they then installed centos-7  and rebooted then nothing  more",
        "ts": "1516304481.000883"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "see: <http:\/\/provision.readthedocs.io\/en\/latest\/doc\/integrations\/krib.html#configure-with-the-cli>",
        "ts": "1516304495.000710"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "the last few paragraphs of that section",
        "ts": "1516304504.000363"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "you need to change the Stage of the Machines to start them on the KRIB install process",
        "ts": "1516304513.000217"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "starting from:  _\"Change stage on the Machines to initiate the Workflow transition.\"_",
        "edited": {
            "user": "U6QFVRJNB",
            "ts": "1516304563.000000"
        },
        "ts": "1516304550.000123"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "or Step 5 in the UX flow in this section: <http:\/\/provision.readthedocs.io\/en\/latest\/doc\/integrations\/krib.html#configure-with-the-ux>",
        "ts": "1516304658.000302"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "and remember what <@U6QFVRJNB> told us last night... please note that a Stage and a BootEnv are two different things (see 7:20PM shane)",
        "ts": "1516304726.000211"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "ok maybe im an idiot but ive done  what you both are telling me to  do",
        "ts": "1516304942.000603"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "<@U6QFVRJNB> check my math... but something is amiss... <http:\/\/provision.readthedocs.io\/en\/latest\/doc\/quickstart.html#install-your-first-machine>",
        "ts": "1516305023.000238"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "or I'm still confused on when you 'should could' Stage vs BootEnv",
        "ts": "1516305108.000597"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "can you please provide a screenshot of UI Machines panel - or run this `drpcli` command:\n`drpcli machines list | jq -r '.[] | \"\\(.Name) : \\(.Stage) : \\(.BootEnv)\"'`",
        "ts": "1516305139.000510"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "<@U62R1805P> see the Note - this is not using Workflow\/Stages to move a machine through provisioning process",
        "ts": "1516305235.000112"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "using a workflow and stages is different",
        "ts": "1516305241.000802"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "that process highlights manually moving a machine through provisioning steps",
        "ts": "1516305284.000532"
    },
    {
        "type": "message",
        "user": "U62R1805P",
        "text": "yea... but the instructions on the quickstart did not work 4me (I had to use stage, not bootenv... as the machine was sitting in sledgehammer... I think..)  and still wrapping my head around it... I get now that workflow need to plan for expected future events...  I was going back over rob and greg video of some of that to see what I was missing...",
        "ts": "1516305540.000234"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "drpcli machines list | jq -r '.[] | \"\\(.Name) : \\(.Stage) : \\(.BootEnv)\"'\n<http:\/\/static.18.24.251.148.clients.your-server.de|static.18.24.251.148.clients.your-server.de> : centos-7-install : centos-7-install\n<http:\/\/static.16.24.251.148.clients.your-server.de|static.16.24.251.148.clients.your-server.de> : centos-7-install : centos-7-install\n<http:\/\/static.17.24.251.148.clients.your-server.de|static.17.24.251.148.clients.your-server.de> : centos-7-install : centos-7-install",
        "ts": "1516305573.000154"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "ok this is 3 new machines",
        "ts": "1516305579.000377"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "my_machines stage ssh-access\n+ drpcli machines stage 86064587-bd6f-4999-ad0b-772ee5ed12c5 ssh-access\nError: ValidationError: machines\/86064587-bd6f-4999-ad0b-772ee5ed12c5: Can not change stages with pending tasks unless forced\n+ set +x\n+ drpcli machines stage 1d064d6f-cf06-4a11-a1d6-7b23766ba5a0 ssh-access\nError: ValidationError: machines\/1d064d6f-cf06-4a11-a1d6-7b23766ba5a0: Can not change stages with pending tasks unless forced\n+ set +x\n+ drpcli machines stage d72597cb-390a-4f96-8cf8-0b72dca2364b ssh-access\nError: ValidationError: machines\/d72597cb-390a-4f96-8cf8-0b72dca2364b: Can not change stages with pending tasks unless forced\n+ set +x",
        "ts": "1516305653.000371"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "jeeezzz....",
        "ts": "1516305660.000470"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "my_machines action powercycle\n+ drpcli machines action 86064587-bd6f-4999-ad0b-772ee5ed12c5 powercycle\nError: GET: machines\/86064587-bd6f-4999-ad0b-772ee5ed12c5: Action powercycle: Not Found\n+ set +x\n+ drpcli machines action 1d064d6f-cf06-4a11-a1d6-7b23766ba5a0 powercycle\nError: GET: machines\/1d064d6f-cf06-4a11-a1d6-7b23766ba5a0: Action powercycle: Not Found\n+ set +x\n+ drpcli machines action d72597cb-390a-4f96-8cf8-0b72dca2364b powercycle\nError: GET: machines\/d72597cb-390a-4f96-8cf8-0b72dca2364b: Action powercycle: Not Found\n+ set +x",
        "ts": "1516306342.000458"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "doesnt even work",
        "edited": {
            "user": "U855MAQFL",
            "ts": "1516306365.000000"
        },
        "ts": "1516306350.000606"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "did you install an IPMI plugin to support power actions ?",
        "ts": "1516306417.000197"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "if not you can't power cycle",
        "ts": "1516306422.000263"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "I failed to mention that in the Doc - you need a Plugin to implement the IPMI power actions",
        "ts": "1516306476.000598"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "actually - I did mention it - briefly",
        "ts": "1516306534.000390"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "i rebooted them from console",
        "ts": "1516306540.000732"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "theirinstalling centos-7 again",
        "ts": "1516306550.000164"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "then theyll probably jus reboo like  before and do nothing",
        "ts": "1516306565.000049"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "centos-7-install\nStart\nrunner-service\nSuccess (remove step)\nfinish-install\nStop (remove step)\ndocker-install\nSuccess (remove step)\nkrib-install\nSuccess (remove step)\ncomplete\nSuccess (remove step)\ndiscover\nStart\nsledgehammer-wait\nSuccess (remove step)",
        "ts": "1516306576.000023"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "thats the work flow for the profile",
        "ts": "1516306584.001008"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "What profile did you create this in?",
        "ts": "1516306596.000636"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "k8s",
        "ts": "1516306607.000742"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "i added the profile",
        "ts": "1516306625.000375"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "Is that the only profile on the machines?",
        "edited": {
            "user": "U02DGQYK1",
            "ts": "1516306641.000000"
        },
        "ts": "1516306636.000874"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "well there is default",
        "ts": "1516306649.000659"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "default?",
        "ts": "1516306658.000282"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<https:\/\/pastebin.com\/M2PMYN34>",
        "edited": {
            "user": "U855MAQFL",
            "ts": "1516307398.000000"
        },
        "ts": "1516306749.000335"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "eachmachine has the ks-cluser profile",
        "ts": "1516306807.001221"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "`drpcli profiles show k8s-cluster`",
        "ts": "1516306813.000911"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "and sure enough they are jus sitting there again",
        "ts": "1516306819.001019"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<https:\/\/pastebin.com\/7evuhkLw>",
        "edited": {
            "user": "U855MAQFL",
            "ts": "1516307351.000000"
        },
        "ts": "1516306925.000407"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "oh wait...is in docker install now",
        "ts": "1516306933.000650"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "so something changed",
        "ts": "1516306940.000703"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "The profile shows progress being made.",
        "ts": "1516307038.000094"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "I updated the KRIB doc (in `latest`) to highlight the IPMI actions and Plugin Provider status",
        "ts": "1516307250.000515"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "<@U855MAQFL> - I wouldn're recommend leaving those pastebin's up - you have sensitive tokens and cluster admin related information in those",
        "ts": "1516307425.000020"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "hrmmm  seems hung...2 are still on docker-install",
        "ts": "1516307688.000275"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "ill lesve it be for a while",
        "ts": "1516307700.000110"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "Or you could check the jobs system and see what they say.",
        "ts": "1516307721.001231"
    },
    {
        "type": "message",
        "user": "U02DGQYK1",
        "text": "For example, the jobs for each machine running docker-install.  There should be a job with a log for that.",
        "ts": "1516307741.001034"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "nope seems its hung up on2 nodes inn krib-install",
        "ts": "1516314634.000433"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "check the job log and see why",
        "ts": "1516314940.000368"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "<@U6QFVRJNB> i would if the ui would load it",
        "ts": "1516317204.000278"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "anyway  to do it from cli ?",
        "ts": "1516317212.000278"
    },
    {
        "type": "message",
        "user": "U855MAQFL",
        "text": "2018-01-18T17:44:12\tn\/a\t5ec554d0-0b5d-4bf9-82d9-296ad30af345\te99c4d85-73ca-461e-a599-fc8463a00a7a\tkrib-install\tkrib-install",
        "ts": "1516317261.000048"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "`drpcli jobs list` for all jobs\n`drpcli jobs list | jq \".[] | select(.Machine==\\\"$UUID\\\")\"`",
        "edited": {
            "user": "U6QFVRJNB",
            "ts": "1516317369.000000"
        },
        "ts": "1516317336.000369"
    },
    {
        "type": "message",
        "user": "U6QFVRJNB",
        "text": "(where $UUID is a variable holding the UUID of the machine you'd like to inspect jobs for)",
        "ts": "1516317353.000531"
    }
]