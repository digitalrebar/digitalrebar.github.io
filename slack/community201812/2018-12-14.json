[
    {
        "client_msg_id": "0b5543fd-4b2c-4672-bac2-ff91b2088c0c",
        "type": "message",
        "text": "<!here>\n<https:\/\/github.com\/bjwschaap\/digital-rebar-sandbox>",
        "user": "UEU1YT30X",
        "ts": "1544774544.516200",
        "attachments": [
            {
                "service_name": "GitHub",
                "title": "bjwschaap\/digital-rebar-sandbox",
                "title_link": "https:\/\/github.com\/bjwschaap\/digital-rebar-sandbox",
                "text": "A Vagrant+Ansible setup for spinning up a VM with dr-provision. - bjwschaap\/digital-rebar-sandbox",
                "fallback": "GitHub: bjwschaap\/digital-rebar-sandbox",
                "from_url": "https:\/\/github.com\/bjwschaap\/digital-rebar-sandbox",
                "thumb_url": "https:\/\/avatars0.githubusercontent.com\/u\/2477789?s=400&v=4",
                "thumb_width": 250,
                "thumb_height": 250,
                "service_icon": "https:\/\/a.slack-edge.com\/bfaba\/img\/unfurl_icons\/github.png",
                "id": 1,
                "original_url": "https:\/\/github.com\/bjwschaap\/digital-rebar-sandbox"
            }
        ]
    },
    {
        "type": "message",
        "text": "Sandbox running…",
        "files": [
            {
                "id": "FETSQRKU2",
                "created": 1544775393,
                "timestamp": 1544775393,
                "name": "image.png",
                "title": "Pasted image at 2018-12-14, 9:16 AM",
                "mimetype": "image\/png",
                "filetype": "png",
                "pretty_type": "PNG",
                "user": "UEU1YT30X",
                "editable": false,
                "size": 390442,
                "mode": "hosted",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FETSQRKU2\/image.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FETSQRKU2\/download\/image.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_64": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_64.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_80": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_80.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_360": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_360.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_360_w": 360,
                "thumb_360_h": 188,
                "thumb_480": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_480.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_480_w": 480,
                "thumb_480_h": 251,
                "thumb_160": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_160.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_720": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_720.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_720_w": 720,
                "thumb_720_h": 377,
                "thumb_800": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_800.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_800_w": 800,
                "thumb_800_h": 419,
                "thumb_960": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_960.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_960_w": 960,
                "thumb_960_h": 502,
                "thumb_1024": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FETSQRKU2-bf79da1220\/image_1024.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_1024_w": 1024,
                "thumb_1024_h": 536,
                "image_exif_rotation": 1,
                "original_w": 2542,
                "original_h": 1330,
                "permalink": "https:\/\/rackn.slack.com\/files\/UEU1YT30X\/FETSQRKU2\/image.png",
                "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-FETSQRKU2-c44c4c0938"
            }
        ],
        "upload": true,
        "user": "UEU1YT30X",
        "display_as_bot": false,
        "ts": "1544775399.516400"
    },
    {
        "type": "message",
        "text": "The only problem I have right now, is that the ip forwarding doesn’t seem to work, since it can’t reach the internet to download packages:",
        "files": [
            {
                "id": "FET90FTT3",
                "created": 1544775547,
                "timestamp": 1544775547,
                "name": "image.png",
                "title": "Pasted image at 2018-12-14, 9:19 AM",
                "mimetype": "image\/png",
                "filetype": "png",
                "pretty_type": "PNG",
                "user": "UEU1YT30X",
                "editable": false,
                "size": 66219,
                "mode": "hosted",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FET90FTT3\/image.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FET90FTT3\/download\/image.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_64": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_64.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_80": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_80.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_360": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_360.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_360_w": 360,
                "thumb_360_h": 294,
                "thumb_480": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_480.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_480_w": 480,
                "thumb_480_h": 392,
                "thumb_160": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_160.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_720": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_720.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_720_w": 720,
                "thumb_720_h": 588,
                "thumb_800": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_800.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_800_w": 800,
                "thumb_800_h": 654,
                "thumb_960": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_960.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_960_w": 960,
                "thumb_960_h": 785,
                "thumb_1024": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET90FTT3-3130fb3e4b\/image_1024.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_1024_w": 1024,
                "thumb_1024_h": 837,
                "image_exif_rotation": 1,
                "original_w": 1270,
                "original_h": 1038,
                "permalink": "https:\/\/rackn.slack.com\/files\/UEU1YT30X\/FET90FTT3\/image.png",
                "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-FET90FTT3-863a41705e"
            }
        ],
        "upload": true,
        "user": "UEU1YT30X",
        "display_as_bot": false,
        "ts": "1544775552.517400"
    },
    {
        "type": "message",
        "text": "",
        "files": [
            {
                "id": "FET912XA5",
                "created": 1544775609,
                "timestamp": 1544775609,
                "name": "image.png",
                "title": "Pasted image at 2018-12-14, 9:20 AM",
                "mimetype": "image\/png",
                "filetype": "png",
                "pretty_type": "PNG",
                "user": "UEU1YT30X",
                "editable": false,
                "size": 71004,
                "mode": "hosted",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FET912XA5\/image.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FET912XA5\/download\/image.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_64": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_64.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_80": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_80.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_360": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_360.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_360_w": 360,
                "thumb_360_h": 281,
                "thumb_480": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_480.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_480_w": 480,
                "thumb_480_h": 374,
                "thumb_160": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_160.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_720": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_720.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_720_w": 720,
                "thumb_720_h": 561,
                "thumb_800": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_800.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_800_w": 800,
                "thumb_800_h": 623,
                "thumb_960": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_960.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_960_w": 960,
                "thumb_960_h": 748,
                "thumb_1024": "https:\/\/files.slack.com\/files-tmb\/T02DGQYJZ-FET912XA5-331ba8e814\/image_1024.png?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "thumb_1024_w": 1024,
                "thumb_1024_h": 798,
                "image_exif_rotation": 1,
                "original_w": 1278,
                "original_h": 996,
                "permalink": "https:\/\/rackn.slack.com\/files\/UEU1YT30X\/FET912XA5\/image.png",
                "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-FET912XA5-74fc144968"
            }
        ],
        "upload": true,
        "user": "UEU1YT30X",
        "display_as_bot": false,
        "ts": "1544775614.517700"
    },
    {
        "type": "message",
        "text": "enp0s3 (10.20 address) is the NAT i.f., enp0s8 (192.168.33 address) is the internal host-only i.f.",
        "files": [
            {
                "id": "FET93T1RP",
                "created": 1544775911,
                "timestamp": 1544775911,
                "name": "-.txt",
                "title": "Untitled",
                "mimetype": "text\/plain",
                "filetype": "text",
                "pretty_type": "Plain Text",
                "user": "UEU1YT30X",
                "editable": true,
                "size": 1495,
                "mode": "snippet",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FET93T1RP\/-.txt?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FET93T1RP\/download\/-.txt?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "permalink": "https:\/\/rackn.slack.com\/files\/UEU1YT30X\/FET93T1RP\/-.txt",
                "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-FET93T1RP-202c3174ba",
                "edit_link": "https:\/\/rackn.slack.com\/files\/UEU1YT30X\/FET93T1RP\/-.txt\/edit",
                "preview": "root@drb:~# sysctl net.ipv4.ip_forward\r\nnet.ipv4.ip_forward = 1\r\nroot@drb:~# ip a\r\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\r\n    link\/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r",
                "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>root@drb:~# sysctl net.ipv4.ip_forward<\/pre><\/div>\n<div><pre>net.ipv4.ip_forward = 1<\/pre><\/div>\n<div><pre>root@drb:~# ip a<\/pre><\/div>\n<div><pre>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1<\/pre><\/div>\n<div><pre>    link\/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<\/div>\n<\/div>\n",
                "lines": 34,
                "lines_more": 29,
                "preview_is_truncated": true
            }
        ],
        "upload": true,
        "user": "UEU1YT30X",
        "display_as_bot": false,
        "ts": "1544775912.518000"
    },
    {
        "client_msg_id": "5a3d6bdc-16fc-465b-80e0-727ed3469ac4",
        "type": "message",
        "text": "Found the problem: I had the default gw set to 192.168.33.1, while it should be 192.168.33.10 (the ip of the drb host)",
        "user": "UEU1YT30X",
        "ts": "1544783138.519100"
    },
    {
        "client_msg_id": "f5e7959d-2dbf-433d-b6ec-3bde65cd282f",
        "type": "message",
        "text": "hello",
        "user": "UEPR4J1P0",
        "ts": "1544795440.519300"
    },
    {
        "client_msg_id": "f93bb3e6-b918-4e10-924a-5ea0cfb161b5",
        "type": "message",
        "text": "I am currently working with packer\/terraform\/containerpilot to build immutable images.",
        "user": "UEPR4J1P0",
        "ts": "1544795490.520000"
    },
    {
        "client_msg_id": "0b7e8e31-105a-4885-bef5-d5d6840e05f7",
        "type": "message",
        "text": "Currently it is in VM on vsphere and aws. Some input are done through user_data.",
        "user": "UEPR4J1P0",
        "ts": "1544795525.520700"
    },
    {
        "client_msg_id": "9b96b278-5863-4e45-8bf7-5b27cca8271f",
        "type": "message",
        "text": "If I create some image with packer using squashfs for example. Is it possible to use digital rebar to provision physical server with this kind of image ?",
        "user": "UEPR4J1P0",
        "ts": "1544795580.521900"
    },
    {
        "client_msg_id": "283f0599-f852-4066-9dda-069eea119e83",
        "type": "message",
        "text": "<@UEPR4J1P0> - Yes.  That is effectively what sledgehammer is.   This would allow you to live boot.  If you wish to “install” that to a disk, that is what the RackN image-deploy plugin can do.",
        "user": "U02DGQYK1",
        "ts": "1544797260.524200"
    },
    {
        "client_msg_id": "5fc4d2c3-a872-4967-b70e-96ac25f4bf32",
        "type": "message",
        "text": "so once last week and this morning, the sledgehammer UI has reported the backend not available. Persists across browers, but curl commands to the API work. dr-provision seems to continue working.  Restarting dr-provision brings it back right away.",
        "user": "UE4C36RV4",
        "ts": "1544797427.526000"
    },
    {
        "client_msg_id": "d2f45d26-95b5-442c-ba81-e82f8478f6cd",
        "type": "message",
        "text": "It's in this state right now, and I found some log entries.  Curious if there's anything else we can look at or try before restarting it",
        "user": "UE4C36RV4",
        "ts": "1544797450.526600"
    },
    {
        "type": "message",
        "text": "",
        "files": [
            {
                "id": "FEUAWTB3P",
                "created": 1544797459,
                "timestamp": 1544797459,
                "name": "-.sh",
                "title": "Untitled",
                "mimetype": "text\/plain",
                "filetype": "shell",
                "pretty_type": "Shell",
                "user": "UE4C36RV4",
                "editable": true,
                "size": 6885,
                "mode": "snippet",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FEUAWTB3P\/-.sh?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FEUAWTB3P\/download\/-.sh?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "permalink": "https:\/\/rackn.slack.com\/files\/UE4C36RV4\/FEUAWTB3P\/-.sh",
                "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-FEUAWTB3P-b59300c986",
                "edit_link": "https:\/\/rackn.slack.com\/files\/UE4C36RV4\/FEUAWTB3P\/-.sh\/edit",
                "preview": "Dec 14 14:15:55 metal35-r01 dr-provision[1531]: [869:90]Authenticated user adminuser from 10.131.147.112\r\nDec 14 14:16:27 metal35-r01 dr-provision[1531]: Tried to access unlocked resource profiles\r\nDec 14 14:16:27 metal35-r01 dr-provision[1531]: #033[31m2018\/12\/14 14:16:27 [Recovery] 2018\/12\/14 - 14:16:27 panic recovered:\r\nDec 14 14:16:27 metal35-r01 dr-provision[1531]: PATCH \/api\/v3\/tasks\/ipmi-user-dev HTTP\/2.0\r\nDec 14 14:16:27 metal35-r01 dr-provision[1531]: Host: metal:8092\r",
                "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>Dec <span class=\"cm-number\">14<\/span> <span class=\"cm-number\">14<\/span>:15:55 metal35-r01 dr-provision[1531]: [869:90]Authenticated user adminuser from <span class=\"cm-number\">10<\/span>.131.147.112<\/pre><\/div>\n<div><pre>Dec <span class=\"cm-number\">14<\/span> <span class=\"cm-number\">14<\/span>:16:27 metal35-r01 dr-provision[1531]: Tried to access unlocked resource profiles<\/pre><\/div>\n<div><pre>Dec <span class=\"cm-number\">14<\/span> <span class=\"cm-number\">14<\/span>:16:27 metal35-r01 dr-provision[1531]: <span class=\"cm-comment\">#033[31m2018\/12\/14 14:16:27 [Recovery] 2018\/12\/14 - 14:16:27 panic recovered:<\/span><\/pre><\/div>\n<div><pre>Dec <span class=\"cm-number\">14<\/span> <span class=\"cm-number\">14<\/span>:16:27 metal35-r01 dr-provision[1531]: PATCH \/api\/v3\/tasks\/ipmi-user-dev HTTP\/2.0<\/pre><\/div>\n<div><pre>Dec <span class=\"cm-number\">14<\/span> <span class=\"cm-number\">14<\/span>:16:27 metal35-r01 dr-provision[1531]: Host: metal:8092<\/pre><\/div>\n<\/div>\n<\/div>\n",
                "lines": 53,
                "lines_more": 48,
                "preview_is_truncated": true
            }
        ],
        "upload": true,
        "user": "UE4C36RV4",
        "display_as_bot": false,
        "ts": "1544797460.526700"
    },
    {
        "client_msg_id": "f87cdc6b-136d-48f2-bcc0-f454545d37c4",
        "type": "message",
        "text": "actually.. while it basically responds, I am seeing that it's not really responding. any requests for things like a list of profiles or tasks is just kind of pending",
        "user": "UE4C36RV4",
        "ts": "1544797583.527700"
    },
    {
        "client_msg_id": "a941dc7e-91ed-4cc6-892f-a0977de0bad0",
        "type": "message",
        "text": "<@U02DGQYK1> If i understand correctly i can use sledgehammer to boot the machine from a live image (centos live cd for example), then download the squashfs image from http\/ftp and finally  install it on the disk and reboot the machine",
        "user": "UEPR4J1P0",
        "ts": "1544797781.529500"
    },
    {
        "client_msg_id": "7cb1744d-280e-4988-984b-4e10309f2df2",
        "type": "message",
        "text": "<@UE4C36RV4> - can you please open a giihub issue with that stack trace?",
        "user": "U02DGQYK1",
        "ts": "1544797855.530000"
    },
    {
        "client_msg_id": "fb3b9b95-a45a-4eaf-b10d-f928e57ba07d",
        "type": "message",
        "text": "sure thing.",
        "user": "UE4C36RV4",
        "ts": "1544797868.530200"
    },
    {
        "client_msg_id": "d5500ba3-a60e-429a-8e65-bfbcada6976a",
        "type": "message",
        "text": "Please include DRP version and content version.",
        "user": "U02DGQYK1",
        "ts": "1544797901.530600"
    },
    {
        "client_msg_id": "6a5b6992-0815-4769-bf70-927cc38c049d",
        "type": "message",
        "text": "<@UEPR4J1P0> - yes you can do that yourself or use the image-deploy plugin.",
        "user": "U02DGQYK1",
        "ts": "1544797946.531200"
    },
    {
        "client_msg_id": "354b85c5-00e6-48af-854d-9c9001ad9ac9",
        "type": "message",
        "text": "With the image-deploy plugin, after copying the image to the disk, is-it possible to download a file and put it on this disk before rebooting. For the user_data ...",
        "user": "UEPR4J1P0",
        "ts": "1544798067.532700"
    },
    {
        "client_msg_id": "3daa0571-89f7-4a1d-96b8-5b0da48927f9",
        "type": "message",
        "text": "yes",
        "user": "U02DGQYK1",
        "ts": "1544798218.532900"
    },
    {
        "client_msg_id": "ea0b92de-dfd1-4eeb-8011-12ccb9927cac",
        "type": "message",
        "text": "Cool. Thanks.",
        "user": "UEPR4J1P0",
        "ts": "1544798426.533300"
    },
    {
        "client_msg_id": "7bdadd4b-3742-46aa-a649-00cb986b3a5c",
        "type": "message",
        "text": "<https:\/\/github.com\/digitalrebar\/provision\/issues\/1029>",
        "user": "UE4C36RV4",
        "ts": "1544798821.533700",
        "attachments": [
            {
                "service_name": "GitHub",
                "title": "dr-provision hangs after failed edit from web ui. · Issue #1029 · digitalrebar\/provision",
                "title_link": "https:\/\/github.com\/digitalrebar\/provision\/issues\/1029",
                "text": "Version: v3.11.0-tip-78-641cca862b5711f61009e77a40d586d67233bb30 User edited a task (ipmi-user-dev) to change where the template pointed to. WebUI came back with: Patch error at line 1: Test op fai...",
                "fallback": "GitHub: dr-provision hangs after failed edit from web ui. · Issue #1029 · digitalrebar\/provision",
                "from_url": "https:\/\/github.com\/digitalrebar\/provision\/issues\/1029",
                "thumb_url": "https:\/\/avatars2.githubusercontent.com\/u\/163156?s=400&v=4",
                "thumb_width": 250,
                "thumb_height": 250,
                "service_icon": "https:\/\/a.slack-edge.com\/bfaba\/img\/unfurl_icons\/github.png",
                "id": 1,
                "original_url": "https:\/\/github.com\/digitalrebar\/provision\/issues\/1029"
            }
        ]
    },
    {
        "client_msg_id": "e9dc8fb2-98da-4433-b67c-80d4b7a06152",
        "type": "message",
        "text": "Thanks I’ll look at it",
        "user": "U02DGQYK1",
        "ts": "1544799230.534500"
    },
    {
        "client_msg_id": "486a9d1c-ef84-4d46-8128-749339691888",
        "type": "message",
        "text": "<@UEU1YT30X> - very cool - thank you for posting that - we'll take a look at it, and see about adding references to it in the Docs",
        "user": "U6QFVRJNB",
        "ts": "1544799248.535000"
    },
    {
        "client_msg_id": "3d9c9bfb-ff99-4f7f-b23a-c5bf0223fbe8",
        "type": "message",
        "text": "<@UE4C36RV4> - I have a fix for it.  Thanks",
        "user": "U02DGQYK1",
        "ts": "1544799607.535300"
    },
    {
        "client_msg_id": "050b1ee4-3f86-49f7-92ba-a6bd4836f5d9",
        "type": "message",
        "text": ":+1:",
        "user": "UE4C36RV4",
        "ts": "1544799624.535500"
    },
    {
        "client_msg_id": "d247901d-a025-48ec-a290-8ed6c251ceb8",
        "type": "message",
        "text": "that is awesome response time :slightly_smiling_face:",
        "user": "UE4C36RV4",
        "ts": "1544799692.535700",
        "reactions": [
            {
                "name": "alarm_clock",
                "users": [
                    "U6QFVRJNB"
                ],
                "count": 1
            }
        ]
    },
    {
        "client_msg_id": "e5e2a7b8-7f14-4249-ba2b-778a5446f5fb",
        "type": "message",
        "text": "hmm weird, I’m getting `join-up.sh` stuck in a loop trying to create a new machine again after CL install",
        "user": "UBXEU90UQ",
        "ts": "1544800573.536400"
    },
    {
        "client_msg_id": "25730709-0bd3-438f-8186-7ef7203d9d44",
        "type": "message",
        "text": "when I copy the token out of the downloaded file and run `drpcli machines list Address=$IP` manually, I get a 403",
        "user": "UBXEU90UQ",
        "ts": "1544800626.537000"
    },
    {
        "client_msg_id": "37aa5c06-7bb6-49a6-98bb-e05101d7474e",
        "type": "message",
        "text": "check DRP user\/pass pairs (auth) is correct for the CLI call",
        "user": "U6QFVRJNB",
        "ts": "1544800683.537600"
    },
    {
        "client_msg_id": "081275d5-1f8b-4912-9d65-ff2e5ebc98a2",
        "type": "message",
        "text": "<@UBXEU90UQ> - hmm let me check - what version content are you at.",
        "user": "U02DGQYK1",
        "ts": "1544800744.538200"
    },
    {
        "client_msg_id": "d1aa1803-68be-4ed3-9f6d-a44e27896242",
        "type": "message",
        "text": "tip deployed about 20 mins ago",
        "user": "UBXEU90UQ",
        "ts": "1544800778.538500"
    },
    {
        "client_msg_id": "5ff10cb6-13f7-4ef0-893f-7f7956ca706b",
        "type": "message",
        "text": "hmm actually, maybe i was just debugging too slow",
        "user": "UBXEU90UQ",
        "ts": "1544800788.538800"
    },
    {
        "client_msg_id": "bd430e4d-b7d0-4fcb-970e-994180129760",
        "type": "message",
        "text": "rebooted, copied RS_TOKEN \/ Endpoint out of the generated ZTP file",
        "user": "UBXEU90UQ",
        "ts": "1544800802.539200"
    },
    {
        "client_msg_id": "a1d05400-aab5-4af5-a456-e14ca1268906",
        "type": "message",
        "text": "`root@cumulus:~# drpcli machines list Address=10.10.254.10`",
        "user": "UBXEU90UQ",
        "ts": "1544800809.539400"
    },
    {
        "client_msg_id": "b554779a-9df1-47f2-9363-7e173402df5d",
        "type": "message",
        "text": "this just returns `[]`",
        "user": "UBXEU90UQ",
        "ts": "1544800812.539600"
    },
    {
        "client_msg_id": "1b0d5eff-bd04-4df1-8e4e-df59fbffcac9",
        "type": "message",
        "text": "but the machine is in drp",
        "user": "UBXEU90UQ",
        "ts": "1544800836.539800"
    },
    {
        "client_msg_id": "2d47e1bf-82cc-413c-80fe-fbb1259d85b6",
        "type": "message",
        "text": "```\nroot@net-test01.lon1:~# RS_KEY=\"...\" drpcli -E <https:\/\/localhost:8092> machines list | jq '.[].Address'\n\"10.10.254.10\"\n```",
        "user": "UBXEU90UQ",
        "ts": "1544800873.540100"
    },
    {
        "client_msg_id": "96e6067f-f9f1-4734-b488-027f57053a71",
        "type": "message",
        "text": "interesting, running the same command on the drp server returns the machine as you’d expect",
        "user": "UBXEU90UQ",
        "ts": "1544800937.540600"
    },
    {
        "client_msg_id": "36032ba0-9ebe-48f0-8dc4-eaafae54346e",
        "type": "message",
        "text": "Is this a known machine?",
        "user": "U02DGQYK1",
        "ts": "1544800958.540800"
    },
    {
        "client_msg_id": "57d9d6a2-b868-4162-8041-37f81c7f2148",
        "type": "message",
        "text": "yep",
        "user": "UBXEU90UQ",
        "ts": "1544800969.541000"
    },
    {
        "client_msg_id": "8224f710-f1ff-4945-8e45-df4e477faca1",
        "type": "message",
        "text": "join-up.sh was run on initial boot, triggered a CL image install using workflow",
        "user": "UBXEU90UQ",
        "ts": "1544800986.541700"
    },
    {
        "client_msg_id": "cfbb081d-1703-45f5-ab31-70e358b1a939",
        "type": "message",
        "text": "at the end of the install the switch reboots into CL, reruns `join-up.sh` from DHCP",
        "user": "UBXEU90UQ",
        "ts": "1544801006.542500"
    },
    {
        "client_msg_id": "03b68f8a-5567-4584-ba8e-6af31b7abe2c",
        "type": "message",
        "text": "sigh - this is a little annoying.",
        "user": "U02DGQYK1",
        "ts": "1544801012.542800"
    },
    {
        "client_msg_id": "66d58da2-f8d2-408e-a3a2-87f63ef99beb",
        "type": "message",
        "text": "are you sending hostname in the DHCP message?",
        "user": "U02DGQYK1",
        "ts": "1544801130.543200"
    },
    {
        "client_msg_id": "997b5163-d86c-4639-96e9-eec4d3d8da7f",
        "type": "message",
        "text": "not certain, i need to dump to find out - but the machine *has* been renamed by this point",
        "user": "UBXEU90UQ",
        "ts": "1544801186.543600"
    },
    {
        "client_msg_id": "8408ae72-870d-445a-9268-7bf850cc91e2",
        "type": "message",
        "text": "(in drp, *not* on the host)",
        "user": "UBXEU90UQ",
        "ts": "1544801205.544000"
    },
    {
        "client_msg_id": "bac80ba5-c032-4cb3-802c-9d818cb5fd2a",
        "type": "message",
        "text": "and `join-up.sh` has the code switched as we tried a couple days ago so it does an IP search if it doesnt find the machine by name",
        "user": "UBXEU90UQ",
        "ts": "1544801239.544600"
    },
    {
        "client_msg_id": "7c5b0cf5-cddd-4cd8-8891-c18ae3bf836d",
        "type": "message",
        "text": "Yes - that token only works if the machine is unknown.",
        "user": "U02DGQYK1",
        "ts": "1544801270.544900"
    },
    {
        "client_msg_id": "f94120f8-ee67-45ba-b429-714192e2203f",
        "type": "message",
        "text": "hmmm",
        "user": "U02DGQYK1",
        "ts": "1544801274.545200"
    },
    {
        "client_msg_id": "53bcfa96-fb64-4874-ac27-5edf27540580",
        "type": "message",
        "text": "ahhhhhh",
        "user": "UBXEU90UQ",
        "ts": "1544801292.545400"
    },
    {
        "client_msg_id": "8e27e5ad-c786-44bf-af21-c178ea654b87",
        "type": "message",
        "text": "okay - one more time.",
        "user": "U02DGQYK1",
        "ts": "1544801341.545700"
    },
    {
        "client_msg_id": "c0846b37-6dfe-479e-b60f-ff786e3bc541",
        "type": "message",
        "text": "I have something I should have done all along.",
        "user": "U02DGQYK1",
        "ts": "1544801349.546000"
    },
    {
        "client_msg_id": "fca6773b-6f80-41e6-bcff-6cd326acdcaf",
        "type": "message",
        "text": "We are broadening the use of join-up.sh - which is cool, but it was intended for things not really pxe booting.  I didn’t put the UUID discovery piece in that path.",
        "user": "U02DGQYK1",
        "ts": "1544801375.546700"
    },
    {
        "client_msg_id": "ccb1fb86-fc11-4b08-a446-b7a14fb5100e",
        "type": "message",
        "text": "yep",
        "user": "UBXEU90UQ",
        "ts": "1544801444.546900"
    },
    {
        "client_msg_id": "12f93461-ecd2-4f91-9038-47b2536a6a60",
        "type": "message",
        "text": "okay - new thing",
        "user": "U02DGQYK1",
        "ts": "1544801547.547100"
    },
    {
        "client_msg_id": "3e12dba5-64de-4d51-b4b4-caffe72242aa",
        "type": "message",
        "text": "Question (and a link is awesome as an answer): What are the auth options for digital rebar\/rackn?",
        "user": "UDRCF03BK",
        "ts": "1544801709.548200"
    },
    {
        "client_msg_id": "aa7fd71a-c530-4d49-8e4d-5e22de25a231",
        "type": "message",
        "text": "for context, we are attempting to consolidate a lot of our logins",
        "user": "UDRCF03BK",
        "ts": "1544801731.548700"
    },
    {
        "client_msg_id": "31ab0526-8708-4c4e-9d26-1fd231212ed1",
        "type": "message",
        "text": "and this is one that clearly has a lot of power",
        "user": "UDRCF03BK",
        "ts": "1544801741.549100"
    },
    {
        "client_msg_id": "a68911c4-12bd-405b-ba1e-8f5b6a552462",
        "type": "message",
        "text": "Not sure about the direction you mean.  But, currently, DRP API is user\/password or token authenticated using our own user objects.",
        "user": "U02DGQYK1",
        "ts": "1544801797.550100"
    },
    {
        "client_msg_id": "f9b7d16b-9182-4503-a06e-52261d532ec5",
        "type": "message",
        "text": "The RackN SaaS is different and probably not what you are asking about.",
        "user": "U02DGQYK1",
        "ts": "1544801816.550700"
    },
    {
        "client_msg_id": "7dccfdf5-f43a-40cc-97d3-6081b8e96f9a",
        "type": "message",
        "text": "DRP is one level for sure",
        "user": "UDRCF03BK",
        "ts": "1544801825.551000"
    },
    {
        "client_msg_id": "dbed01fa-508e-4e83-848c-e99a3d5653b7",
        "type": "message",
        "text": "basically, just about everything else we are using is tied into Google for SSO",
        "user": "UDRCF03BK",
        "ts": "1544801843.551900"
    },
    {
        "client_msg_id": "a611090a-692e-4738-891b-9007dd727dfc",
        "type": "message",
        "text": "RackN is looking at adding LDAP\/AD support in the future.  There could be other integrations.",
        "user": "U02DGQYK1",
        "ts": "1544801845.552000"
    },
    {
        "client_msg_id": "4ea53b91-0f05-4e08-86fd-c89f93ce45c3",
        "type": "message",
        "text": "We have leapt on these options because we believe that DRP will run in airgap modes and so SSO is not an immediate priority, but we are starting to see it show it.",
        "user": "U02DGQYK1",
        "ts": "1544801904.553100"
    },
    {
        "client_msg_id": "3f8ca72c-5d6a-4899-a538-d5a0ef11e985",
        "type": "message",
        "text": "There are two parts to this future integration (at least).  One is the AuthN piece.  The other is the AuthZ piece and how those SSO pieces drive tenants and roles.",
        "user": "U02DGQYK1",
        "ts": "1544801950.554200"
    },
    {
        "client_msg_id": "32c83740-e6c4-47ff-ac5f-056111ad053a",
        "type": "message",
        "text": "I haven’t looked at the Google SSO pieces.  Do you have links for those so I can learn me some stuff.",
        "user": "U02DGQYK1",
        "ts": "1544801991.554900"
    },
    {
        "client_msg_id": "fd3973be-37e6-4c01-bd7b-1de9f3c53c73",
        "type": "message",
        "text": "<@UBXEU90UQ> - update content and try again.",
        "user": "U02DGQYK1",
        "ts": "1544802049.555900"
    },
    {
        "client_msg_id": "a237906e-d319-42d7-bb51-f0662cc04bf4",
        "type": "message",
        "text": "sure, it's google is all just SAML",
        "user": "UDRCF03BK",
        "ts": "1544802072.556100"
    },
    {
        "client_msg_id": "1c1c5c7e-6658-4174-b0de-6e58d58aef2a",
        "type": "message",
        "text": "okay - our v2 product has okta integration and it was kinda SAML.",
        "user": "U02DGQYK1",
        "ts": "1544802107.556600"
    },
    {
        "client_msg_id": "2a1d6358-a9d4-4b37-9117-bd866a6e1a57",
        "type": "message",
        "text": "ok cool",
        "user": "UDRCF03BK",
        "ts": "1544802825.556900"
    },
    {
        "client_msg_id": "0ff3780b-1122-4257-81d9-a3f6038bec74",
        "type": "message",
        "text": "<@U02DGQYK1> same thing I think, what’d you change? (just so I can make sure it actually got pulled in)",
        "user": "UBXEU90UQ",
        "ts": "1544803015.557800"
    },
    {
        "client_msg_id": "b99ca9ca-5072-460f-a8d7-5a37eb26a461",
        "type": "message",
        "text": "```\ndiff --git a\/content\/bootenvs\/discovery.yml b\/content\/bootenvs\/discovery.yml\nindex ec2b7cb..44ec684 100644\n--- a\/content\/bootenvs\/discovery.yml\n+++ b\/content\/bootenvs\/discovery.yml\n@@ -209,11 +209,20 @@ Templates:\n \n       set -x\n \n-      # Code assumes provider has set HOSTNAME correctly!!\n-      RS_UUID=$(drpcli machines list Name=$HOSTNAME | jq -r .[0].Uuid)\n+      # Check just in case we pxe booted.\n+      host_re='rs\\.uuid=([^ ]+)'\n+      if [[ $(cat \/proc\/cmdline) =~ $host_re ]]; then\n+        RS_UUID=\"${BASH_REMATCH[1]}\"\n+      fi\n+\n+      # Check Hostname to find us\n       if [[ $RS_UUID == null || $RS_UUID == \"\" ]]; then\n-        RS_UUID=$(drpcli machines show Name:$HOSTNAME | jq -r .Uuid)\n+        RS_UUID=$(drpcli machines list Name=$HOSTNAME | jq -r .[0].Uuid)\n+        if [[ $RS_UUID == null || $RS_UUID == \"\" ]]; then\n+          RS_UUID=$(drpcli machines show Name:$HOSTNAME | jq -r .Uuid)\n+        fi\n       fi\n+\n       # If no uuid, check to see if we have one stored from before\n       if [[ $RS_UUID == null || $RS_UUID == \"\" ]]; then\n         # See if we have already been created based on dropping uuid file\n\n```",
        "user": "U02DGQYK1",
        "ts": "1544803101.558200"
    },
    {
        "client_msg_id": "3eab5e90-3ad9-4a02-a70d-7c5f0dd5e287",
        "type": "message",
        "text": "never mind, it won’t work for you.",
        "user": "U02DGQYK1",
        "ts": "1544803115.558600"
    },
    {
        "client_msg_id": "d58255c5-645b-4bce-b794-cdc7c8f37c22",
        "type": "message",
        "text": "sigh",
        "user": "U02DGQYK1",
        "ts": "1544803117.558800"
    },
    {
        "client_msg_id": "7219e243-e626-40e2-94a3-7cc26fc91e8b",
        "type": "message",
        "text": "It works for other systems.",
        "user": "U02DGQYK1",
        "ts": "1544803127.559000"
    },
    {
        "client_msg_id": "8fc8050a-a338-41d9-a05a-4e9bbc1886fe",
        "type": "message",
        "text": "that actually pxe.",
        "user": "U02DGQYK1",
        "ts": "1544803131.559200"
    },
    {
        "client_msg_id": "d493ff2d-555a-4aff-86bc-7ccda58b6b54",
        "type": "message",
        "text": "ahh… yeah :disappointed:",
        "user": "UBXEU90UQ",
        "ts": "1544803137.559500"
    },
    {
        "client_msg_id": "8d2be546-70c2-40be-9d9e-ea828d97f9b7",
        "type": "message",
        "text": "So - the probielm is that your hostname doesn’t match what DRP knows",
        "user": "U02DGQYK1",
        "ts": "1544803148.559800",
        "edited": {
            "user": "U02DGQYK1",
            "ts": "1544803152.000000"
        }
    },
    {
        "client_msg_id": "5c282809-cff0-4317-a9eb-6c664f089081",
        "type": "message",
        "text": "yeah as the installer blats whatever the hostname was regardless",
        "user": "UBXEU90UQ",
        "ts": "1544803181.560400"
    },
    {
        "client_msg_id": "a3ff418f-d386-499f-91fc-95632d4c2e24",
        "type": "message",
        "text": "The only think I can think of is that the Hostname needs to be sent in the DHCP exchange.",
        "user": "U02DGQYK1",
        "ts": "1544803306.560900"
    },
    {
        "client_msg_id": "34d13832-2cfd-47e3-8596-a6e268fa0e5c",
        "type": "message",
        "text": "but that might not work either for the switch.",
        "user": "U02DGQYK1",
        "ts": "1544803327.561400"
    },
    {
        "client_msg_id": "0aea71e2-4fa1-4d61-bb86-debb2a511985",
        "type": "message",
        "text": "<https:\/\/docs.cumulusnetworks.com\/display\/DOCS\/Zero+Touch+Provisioning+-+ZTP> theres a note in here that says “Make sure to disable the DHCP hostname override setting in your script”",
        "user": "UBXEU90UQ",
        "ts": "1544803366.561800"
    },
    {
        "client_msg_id": "fc3ae95c-9b65-41d6-89fb-cbcf9e4a8934",
        "type": "message",
        "text": "and then says its already disabled for CL 3.5 and above :confused:",
        "user": "UBXEU90UQ",
        "ts": "1544803374.562100"
    },
    {
        "client_msg_id": "3395a35e-613a-4315-a919-193628162d40",
        "type": "message",
        "text": "is DRP able to reply to DHCP requests with the hostname it knows about?",
        "user": "UBXEU90UQ",
        "ts": "1544803567.562600"
    },
    {
        "client_msg_id": "37158c6a-2b75-4a4f-bc2f-d71e109cfab2",
        "type": "message",
        "text": "No - you can create a reservation and set the hostname there.",
        "user": "U02DGQYK1",
        "ts": "1544803592.563200"
    },
    {
        "client_msg_id": "6b03223b-d7ba-4711-bdb3-583825c7dd40",
        "type": "message",
        "text": "but the reservation and the machine name are not synchronized.",
        "user": "U02DGQYK1",
        "ts": "1544803626.563600"
    },
    {
        "client_msg_id": "113e8531-21a1-4648-8e93-92afe2cf36ff",
        "type": "message",
        "text": "automatically",
        "user": "U02DGQYK1",
        "ts": "1544803631.563800"
    },
    {
        "client_msg_id": "b46c17db-c56e-4b4e-84f6-1c57ea3bcf00",
        "type": "message",
        "text": "hmmmmm",
        "user": "UBXEU90UQ",
        "ts": "1544803655.564000"
    },
    {
        "client_msg_id": "28f5807a-7e22-47dd-9296-76f09f200671",
        "type": "message",
        "text": "so i have a step which pulls the machine name and such from netbox",
        "user": "UBXEU90UQ",
        "ts": "1544803671.564400"
    },
    {
        "client_msg_id": "095a00db-0dd6-48e2-9c91-c4891e38502a",
        "type": "message",
        "text": "if i can create the reservation at the same time, that might work",
        "user": "UBXEU90UQ",
        "ts": "1544803682.564800"
    },
    {
        "client_msg_id": "952b0952-a88d-42c0-843a-9d6a01803023",
        "type": "message",
        "text": "yes",
        "user": "U02DGQYK1",
        "ts": "1544803687.565000"
    },
    {
        "client_msg_id": "f7548800-dce7-4412-8b0d-276898befc26",
        "type": "message",
        "text": "i dont think synchronisation matters as the machine name should never change until next provision",
        "user": "UBXEU90UQ",
        "ts": "1544803703.565700"
    },
    {
        "client_msg_id": "8db2c25f-da85-49e8-af49-b9d872492bab",
        "type": "message",
        "text": "The task can create reservations, I believe.",
        "user": "U02DGQYK1",
        "ts": "1544803709.565900"
    },
    {
        "client_msg_id": "aece4297-68ed-441e-9270-7b0aadfba502",
        "type": "message",
        "text": "our IPMI configuration stage does it.",
        "user": "U02DGQYK1",
        "ts": "1544803726.566200"
    },
    {
        "client_msg_id": "5bea5a2d-6723-4f5f-a3d4-18cedadabc79",
        "type": "message",
        "text": "<@UE4C36RV4> - drp tip has your fix in it",
        "user": "U02DGQYK1",
        "ts": "1544803755.566700",
        "reactions": [
            {
                "name": "heart",
                "users": [
                    "UE4C36RV4",
                    "U02DHRR2L"
                ],
                "count": 2
            }
        ]
    },
    {
        "client_msg_id": "04361e1e-4902-425a-83ff-9f23a8daceeb",
        "type": "message",
        "text": "okay, thanks <@U02DGQYK1> I’ll give it a shot",
        "user": "UBXEU90UQ",
        "ts": "1544803778.567300"
    },
    {
        "client_msg_id": "abc56814-d0d9-4c5b-867c-742e2c817ebe",
        "type": "message",
        "text": "cool - let me know how it goes",
        "user": "U02DGQYK1",
        "ts": "1544803808.568000"
    },
    {
        "client_msg_id": "06d18fa7-acca-4223-a6ca-313ff5a9f3fa",
        "type": "message",
        "text": "ok… creating a reservation manually works, but when the install completes and reboots, it looks like DRP joins the machine back up and then restarts the install process",
        "user": "UBXEU90UQ",
        "ts": "1544805273.569200"
    },
    {
        "client_msg_id": "751f0911-a347-4714-b10e-ffd99849fc6d",
        "type": "message",
        "text": "i need to somehow tell it that the install stage is complete :smile:",
        "user": "UBXEU90UQ",
        "ts": "1544805288.569600"
    },
    {
        "client_msg_id": "f9d2e6ba-f03d-4829-bed7-4620ba003356",
        "type": "message",
        "text": "in your onie-install stage.",
        "user": "U02DGQYK1",
        "ts": "1544805385.569800"
    },
    {
        "client_msg_id": "b369f94d-5e29-4115-a7a6-4209c3d7fc42",
        "type": "message",
        "text": "change workflows to a complete workflow.",
        "user": "U02DGQYK1",
        "ts": "1544805406.570100"
    },
    {
        "client_msg_id": "d90702c1-d598-4f3d-bb76-cfb98f1562c6",
        "type": "message",
        "text": "after the install, but before the reboot.",
        "user": "U02DGQYK1",
        "ts": "1544805423.570400"
    },
    {
        "client_msg_id": "6b9015d7-fd2e-4562-8d22-54c6124db5f6",
        "type": "message",
        "text": "or before the install if it reboots.",
        "user": "U02DGQYK1",
        "ts": "1544805428.570600"
    },
    {
        "client_msg_id": "8979e648-b689-4f7e-a9f9-b969f619ca37",
        "type": "message",
        "text": "sigh, ignore my stupidity - i uploaded a 3.7.2 image as 3.7.3 to force the switch to run an install from the start",
        "user": "UBXEU90UQ",
        "ts": "1544805517.571100"
    },
    {
        "client_msg_id": "6c4423ed-b23d-406c-9ff1-cd61f5866abe",
        "type": "message",
        "text": "so it always fails the version check and always reinstalls :woman-facepalming:",
        "user": "UBXEU90UQ",
        "ts": "1544805531.571600"
    },
    {
        "client_msg_id": "54959695-f6df-4cb5-b058-592214eeeeac",
        "type": "message",
        "text": "if the version is correct it’ll just skip over the version check, exit 0 and continue with config",
        "user": "UBXEU90UQ",
        "ts": "1544805557.571900"
    },
    {
        "client_msg_id": "60b0783d-7b00-4806-a6a4-021ff7bfb623",
        "type": "message",
        "text": "lucky this is PoC hardware cos it’s probably hammering the storage reinstalling this 20 times over :smile:",
        "user": "UBXEU90UQ",
        "ts": "1544805662.572400"
    },
    {
        "client_msg_id": "7bcb9655-46fe-47ec-9221-34920d69b004",
        "type": "message",
        "text": "Is there any work being done to allow for google auth in the web UI?",
        "user": "UCXU3160M",
        "ts": "1544808571.573000"
    },
    {
        "client_msg_id": "8f07a4d4-360d-4163-adf8-7566b55cad14",
        "type": "message",
        "text": "or SSO in general",
        "user": "UCXU3160M",
        "ts": "1544808580.573200"
    },
    {
        "client_msg_id": "b7c0708e-49a1-440c-b7d7-ba289e526919",
        "type": "message",
        "text": "<@UDRCF03BK> asked about it above-^",
        "user": "U02DGQYK1",
        "ts": "1544808614.573600"
    },
    {
        "client_msg_id": "50926413-6567-40a3-96b9-fa80f4860597",
        "type": "message",
        "text": "damn, he beat me too it",
        "user": "UCXU3160M",
        "ts": "1544808640.573800"
    },
    {
        "client_msg_id": "d12a9880-749c-4445-ba53-ebd0a4de61c3",
        "type": "message",
        "text": ":slightly_smiling_face:",
        "user": "U02DGQYK1",
        "ts": "1544808682.574000"
    },
    {
        "client_msg_id": "de984924-935f-43c9-b283-a01700ba6994",
        "type": "message",
        "text": "<@UCXU3160M> webui can do it via cognito.  I'd need to collaborate to integrate but the code is there anyway",
        "user": "U02DHRR2L",
        "ts": "1544809590.575400"
    },
    {
        "client_msg_id": "84ad3fa8-cf4e-4a12-a8d8-537585e67adf",
        "type": "message",
        "text": "Webui auth is different than endpoint auth",
        "user": "U02DHRR2L",
        "ts": "1544809665.576200"
    },
    {
        "client_msg_id": "8592c904-3dd3-4dde-b9b0-19d311662505",
        "type": "message",
        "text": "<@U02DHRR2L> = yep covered above.",
        "user": "U02DGQYK1",
        "ts": "1544810544.576700"
    },
    {
        "client_msg_id": "2323c6d4-bf0c-4cca-a004-a5744176fc52",
        "type": "message",
        "text": "<@UCXU3160M> - when Rob says WebUI via cognito, he is meaning the RackN SaaS auth piece.  The DRP Endpoint API still uses the auth pieces I mention above.  The WebUI works as a bridge between the two systems.  This way DRP Endpoint doesn’t phone home and is still airgappable.",
        "user": "U02DGQYK1",
        "ts": "1544810636.578300"
    },
    {
        "client_msg_id": "30fe2758-50a7-49c2-9283-057d0a26de0c",
        "type": "message",
        "text": "<@U02DGQYK1> auto reservation step worked :smile: bit of shenanigans to look up the MAC for the dhcp-learned IP which I think I can probably improve, and the only other sticking point is getting DRP to run in the management VRF. I think I basically need to modify the service file that gets installed so it runs drp inside the VRF… but thats a problem for monday :slightly_smiling_face: Thanks for your help this week!",
        "user": "UBXEU90UQ",
        "ts": "1544811310.580200"
    },
    {
        "client_msg_id": "ce70a915-6b58-4745-9736-14852a1bc736",
        "type": "message",
        "text": "well - you can multi-home the DRP endpoint and it should work fine.",
        "user": "U02DGQYK1",
        "ts": "1544811597.580600"
    },
    {
        "client_msg_id": "6aca9b02-6fa1-4a5c-8f3f-8b4a56e19e16",
        "type": "message",
        "text": "cool",
        "user": "U02DGQYK1",
        "ts": "1544811610.580800"
    },
    {
        "client_msg_id": "6a35154c-b609-4117-b4a5-03a580dc556d",
        "type": "message",
        "text": "Here's an interesting thing I just discovered.",
        "user": "U9BU09D51",
        "ts": "1544816323.581000"
    },
    {
        "client_msg_id": "f922c806-c11a-479a-bcf3-e8e1f3562ce1",
        "type": "message",
        "text": "Right now the install process I'm working on uses rebar to get a DHCP lease to do the install, then afterwards it sets the IP of the system to its permanent IP (which is not in the DHCP range) so it doesn't conflict with later systems trying to reuse that IP after the lease expires.",
        "user": "U9BU09D51",
        "ts": "1544816419.582200"
    },
    {
        "client_msg_id": "2cbb58fa-a5b5-4634-881c-9cd0b0de790a",
        "type": "message",
        "text": "But if I try to reinstall that system without re-discovering it, it doesn't work.  Because when it goes through the reinstall the machine gets another DHCP IP, but its system profile has a different IP, so it never picks up that I want it to go back through the install process.",
        "user": "U9BU09D51",
        "ts": "1544816537.583600"
    },
    {
        "client_msg_id": "20ac9e75-5774-4ee4-b0c5-200b337da958",
        "type": "message",
        "text": "I guess I have to unset the IP before I reinstall",
        "user": "U9BU09D51",
        "ts": "1544816556.584000"
    },
    {
        "client_msg_id": "0730d0c0-1d5a-4368-9edb-7b474db010a9",
        "type": "message",
        "text": "Yes - DRP doesn’t change the Address.  The discovery process sets it.",
        "user": "U02DGQYK1",
        "ts": "1544816715.584900"
    },
    {
        "client_msg_id": "368c5107-5355-423a-b96e-7be617233038",
        "type": "message",
        "text": "It is one of internal questions that we’ve ask is should sledgehammer update the Address of the machine when it boots.",
        "user": "U02DGQYK1",
        "ts": "1544816735.585500"
    },
    {
        "client_msg_id": "4fa486fe-4b38-430b-9ad4-6758022c0715",
        "type": "message",
        "text": "I'm wondering why it doesn't go through discovery again then?",
        "user": "U9BU09D51",
        "ts": "1544816743.585700"
    },
    {
        "client_msg_id": "81272655-0267-4b2c-aecb-08432b8aa9c9",
        "type": "message",
        "text": "It just acts like it's set to \"local\"",
        "user": "U9BU09D51",
        "ts": "1544816764.586200"
    },
    {
        "client_msg_id": "b80cba4a-3c62-482e-8cee-3422d7d36b45",
        "type": "message",
        "text": "Because the mac addresses find an ipxe file and set it.",
        "user": "U02DGQYK1",
        "ts": "1544816767.586500"
    },
    {
        "client_msg_id": "ac01a328-51f9-4664-8040-00938b146dab",
        "type": "message",
        "text": "Does it get into sledgehammer?",
        "user": "U02DGQYK1",
        "ts": "1544816774.586700"
    },
    {
        "client_msg_id": "de8c4800-5d92-4e55-8561-75a0c6648bd7",
        "type": "message",
        "text": "No.",
        "user": "U9BU09D51",
        "ts": "1544816778.586900"
    },
    {
        "client_msg_id": "7ebcc2ca-0d20-4713-94ef-78f69c772a5a",
        "type": "message",
        "text": "But this might be another IP address re-use issue.",
        "user": "U9BU09D51",
        "ts": "1544816786.587200"
    },
    {
        "client_msg_id": "96c6a825-2672-4fbd-be2b-e254aabe49ff",
        "type": "message",
        "text": "likely",
        "user": "U02DGQYK1",
        "ts": "1544816792.587600",
        "edited": {
            "user": "U02DGQYK1",
            "ts": "1544816794.000000"
        }
    },
    {
        "client_msg_id": "61141a02-e38c-49e1-bf45-902bfa0ba569",
        "type": "message",
        "text": "With a system that didn't get changed.",
        "user": "U9BU09D51",
        "ts": "1544816797.587900"
    },
    {
        "client_msg_id": "2d9b3779-8130-4ee1-8505-4de6700ffc47",
        "type": "message",
        "text": "Anyway.  I figured it was probably a design choice. But it messed with me for a bit just now.  :slightly_smiling_face:",
        "user": "U9BU09D51",
        "ts": "1544816830.588600"
    },
    {
        "client_msg_id": "50a891c6-dc2b-453f-839d-18dd4010563d",
        "type": "message",
        "text": "Yeah - at some point, we may want to really think through your use case and see if we can make it better.",
        "user": "U02DGQYK1",
        "ts": "1544816896.589100"
    },
    {
        "client_msg_id": "1579f8fc-3e18-4835-b449-0fe9e4e26b68",
        "type": "message",
        "text": "have you considered creating a DHCP reservation w\/ the intended IP address?",
        "user": "U02DHRR2L",
        "ts": "1544817867.589300"
    },
    {
        "client_msg_id": "9d6e0a0d-5de6-449f-b8b8-faf7ddc38f18",
        "type": "message",
        "text": "<@U9BU09D51> - that might be good.  what <@U02DHRR2L> says",
        "user": "U02DGQYK1",
        "ts": "1544818555.589900"
    },
    {
        "client_msg_id": "539e76d7-dead-49e8-9aca-6a668990044f",
        "type": "message",
        "text": "Yeah, that could be a solution. I'll discuss it with the team.",
        "user": "U9BU09D51",
        "ts": "1544819515.590500",
        "reactions": [
            {
                "name": "beer",
                "users": [
                    "U02DHRR2L"
                ],
                "count": 1
            }
        ]
    },
    {
        "client_msg_id": "b67667e9-cbe0-42a0-9051-c58dff4b8017",
        "type": "message",
        "text": "we have similar scenario. we have an external process (stackstorm)  set the reservation,  wait for the lease to appear, then update the ip address in the machine definition",
        "user": "UE4C36RV4",
        "ts": "1544823974.591900"
    },
    {
        "client_msg_id": "fc880258-bae5-49de-b847-9c8d4e2d764c",
        "type": "message",
        "text": "if you send down the right DRP credentials to the machine (instead of just the usual machine token), you could actually create the reservation and do all that on the machine itself. we just chose to move it upstream a bit",
        "user": "UE4C36RV4",
        "ts": "1544824071.593200"
    },
    {
        "type": "message",
        "text": "this assume you have previously loaded a profile named after the serial and it has a primary_ip parameter",
        "files": [
            {
                "id": "FEUD0N9K6",
                "created": 1544824279,
                "timestamp": 1544824279,
                "name": "reip_sh_tmpl.sh",
                "title": "reip.sh.tmpl",
                "mimetype": "text\/plain",
                "filetype": "shell",
                "pretty_type": "Shell",
                "user": "UE4C36RV4",
                "editable": true,
                "size": 1080,
                "mode": "snippet",
                "is_external": false,
                "external_type": "",
                "is_public": true,
                "public_url_shared": false,
                "display_as_bot": false,
                "username": "",
                "url_private": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FEUD0N9K6\/reip_sh_tmpl.sh?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "url_private_download": "https:\/\/files.slack.com\/files-pri\/T02DGQYJZ-FEUD0N9K6\/download\/reip_sh_tmpl.sh?t=xoxe-2458848645-514023324868-513587761153-b5d59617abb26f254de45b5edf5cc500",
                "permalink": "https:\/\/rackn.slack.com\/files\/UE4C36RV4\/FEUD0N9K6\/reip_sh_tmpl.sh",
                "permalink_public": "https:\/\/slack-files.com\/T02DGQYJZ-FEUD0N9K6-b5fcdd1f0f",
                "edit_link": "https:\/\/rackn.slack.com\/files\/UE4C36RV4\/FEUD0N9K6\/reip_sh_tmpl.sh\/edit",
                "preview": "#!\/bin\/bash\r\nset -x\r\n\r\n# RS_UUID=<uuid of machine>\r\nSERIAL=$(drpcli machines get $RS_UUID param gohai-inventory | jq -r '.DMI.System.SerialNumber')\r",
                "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre><span class=\"cm-meta\">#!\/bin\/bash<\/span><\/pre><\/div>\n<div><pre><span class=\"cm-keyword\">set<\/span> <span class=\"cm-attribute\">-x<\/span><\/pre><\/div>\n<div><pre>&#8203;<\/pre><\/div>\n<div><pre><span class=\"cm-comment\"># RS_UUID=&lt;uuid of machine&gt;<\/span><\/pre><\/div>\n<div><pre><span class=\"cm-def\">SERIAL<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-quote\">$(drpcli machines get <\/span><span class=\"cm-def\">$RS_UUID<\/span><span class=\"cm-quote\"> param gohai-inventory | jq -r '.DMI.System.SerialNumber')<\/span><\/pre><\/div>\n<\/div>\n<\/div>\n",
                "lines": 25,
                "lines_more": 20,
                "preview_is_truncated": true
            }
        ],
        "upload": true,
        "user": "UE4C36RV4",
        "display_as_bot": false,
        "ts": "1544824280.593400"
    },
    {
        "client_msg_id": "893deb52-a2da-46c5-b7e0-42edc1af26ba",
        "type": "message",
        "text": "The machine token does have the ability to create reservations (not list or delete).",
        "user": "U02DGQYK1",
        "ts": "1544824291.593900"
    },
    {
        "client_msg_id": "2c9ce7d7-b461-4248-a033-d3d39ee4b184",
        "type": "message",
        "text": "hmm.. I might have to revisit that. it always failed for us and i figured it was a restriction on the token",
        "user": "UE4C36RV4",
        "ts": "1544824389.594700"
    },
    {
        "client_msg_id": "42115b80-2a2b-40ac-a57a-90f55e7abdcc",
        "type": "message",
        "text": "(failed on creating the reservation... we since learned there is no reason to delete the lease)",
        "user": "UE4C36RV4",
        "ts": "1544824425.595400"
    },
    {
        "client_msg_id": "fa7f6dd5-a933-4915-a69f-1ae0f6163826",
        "type": "message",
        "text": "Here is the go for token construction:",
        "user": "U02DGQYK1",
        "ts": "1544824450.595700"
    },
    {
        "client_msg_id": "2528d598-9314-47d1-8291-92f1e793ffc4",
        "type": "message",
        "text": "```\n        t, _ := NewClaim(r.Machine.Key(), grantor, ttl).\n                AddRawClaim(\"machines\", \"*\", r.Machine.Key()).\n                AddRawClaim(\"params\", \"get\", \"*\").\n                AddRawClaim(\"stages\", \"get\", \"*\").\n                AddRawClaim(\"jobs\", \"create\", r.Machine.Key()).\n                AddRawClaim(\"jobs\", \"get\", r.Machine.Key()).\n                AddRawClaim(\"jobs\", \"update\", r.Machine.Key()).\n                AddRawClaim(\"jobs\", \"actions\", r.Machine.Key()).\n                AddRawClaim(\"jobs\", \"log\", r.Machine.Key()).\n                AddRawClaim(\"tasks\", \"get\", \"*\").\n                AddRawClaim(\"info\", \"get\", \"*\").\n                AddRawClaim(\"events\", \"post\", \"*\").\n                AddRawClaim(\"reservations\", \"create\", \"*\").\n                AddRawClaim(\"reservations\", \"*\", models.Hexaddr(r.Machine.Address)).\n                AddMachine(r.Machine.Key()).\n                AddSecrets(\"\", grantorSecret, r.Machine.Secret).\n                Seal(r.rt.dt.tokenManager)\n```",
        "user": "U02DGQYK1",
        "ts": "1544824457.596000"
    },
    {
        "client_msg_id": "b72eb5a9-3f29-4875-94f1-ab359ed4f87f",
        "type": "message",
        "text": "well i am going to have to try that process again.  it would be nice to get the machine on the right ip as part of its discovery process",
        "user": "UE4C36RV4",
        "ts": "1544824575.596800"
    },
    {
        "client_msg_id": "4b5f0edc-3c89-4a02-8a66-ecfc5a8d761c",
        "type": "message",
        "text": "it should work.  You just can’t search for a reservation and you can only edit your own.",
        "user": "U02DGQYK1",
        "ts": "1544824628.597300"
    },
    {
        "client_msg_id": "9d8b79d9-e438-4e15-8fe8-043c36b68b21",
        "type": "message",
        "text": "Note the “key” of a reservation is the IP address so it is little strange.",
        "user": "U02DGQYK1",
        "ts": "1544824658.597800",
        "edited": {
            "user": "U02DGQYK1",
            "ts": "1544824705.000000"
        }
    }
]